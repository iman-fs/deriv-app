!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@deriv/components"),require("@deriv/shared"),require("@deriv/translations"),require("mobx"),require("react")):"function"==typeof define&&define.amd?define(["@deriv/components","@deriv/shared","@deriv/translations","mobx","react"],t):"object"==typeof exports?exports["@deriv/cashier"]=t(require("@deriv/components"),require("@deriv/shared"),require("@deriv/translations"),require("mobx"),require("react")):e["@deriv/cashier"]=t(e["@deriv/components"],e["@deriv/shared"],e["@deriv/translations"],e.mobx,e.react)}(self,(function(e,t,r,n,o){return(()=>{var i,s,a,c,u={"../../../node_modules/prop-types/factoryWithThrowingShims.js":(e,t,r)=>{"use strict";var n=r("../../../node_modules/prop-types/lib/ReactPropTypesSecret.js");function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,s){if(s!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},"../../../node_modules/prop-types/index.js":(e,t,r)=>{e.exports=r("../../../node_modules/prop-types/factoryWithThrowingShims.js")()},"../../../node_modules/prop-types/lib/ReactPropTypesSecret.js":e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"@deriv/components":t=>{"use strict";t.exports=e},"@deriv/shared":e=>{"use strict";e.exports=t},"@deriv/translations":e=>{"use strict";e.exports=r},mobx:e=>{"use strict";e.exports=n},react:e=>{"use strict";e.exports=o}},l={};function h(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return u[e].call(r.exports,r,r.exports,h),r.exports}h.m=u,h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,h.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var r=Object.create(null);h.r(r);var n={};i=i||[null,s({}),s([]),s(s)];for(var o=2&t&&e;"object"==typeof o&&!~i.indexOf(o);o=s(o))Object.getOwnPropertyNames(o).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,h.d(r,n),r},h.d=(e,t)=>{for(var r in t)h.o(t,r)&&!h.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},h.f={},h.e=e=>Promise.all(Object.keys(h.f).reduce(((t,r)=>(h.f[r](e,t),t)),[])),h.u=e=>"cashier/js/cashier."+e+".4b458ac4203eb84dc516.js",h.miniCssF=e=>{},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},c="@deriv/cashier:",h.l=(e,t,r,n)=>{if(a[e])a[e].push(t);else{var o,i;if(void 0!==r)for(var s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var l=s[u];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==c+r){o=l;break}}o||(i=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,h.nc&&o.setAttribute("nonce",h.nc),o.setAttribute("data-webpack",c+r),o.src=e),a[e]=[t];var d=(t,r)=>{o.onerror=o.onload=null,clearTimeout(f);var n=a[e];if(delete a[e],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((e=>e(r))),t)return t(r)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),i&&document.head.appendChild(o)}},h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="/simti/",(()=>{var e={"cashier-store":0};h.f.j=(t,r)=>{var n=h.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=e[t]=[r,o]));r.push(n[2]=o);var i=h.p+h.u(t),s=new Error;h.l(i,(r=>{if(h.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[i,s,a]=r,c=0;if(i.some((t=>0!==e[t]))){for(n in s)h.o(s,n)&&(h.m[n]=s[n]);a&&a(h)}for(t&&t(r);c<i.length;c++)o=i[c],h.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunk_deriv_cashier=self.webpackChunk_deriv_cashier||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var d={};return(()=>{"use strict";h.d(d,{default:()=>Ye});var e=h("mobx"),t=h("@deriv/shared");function r(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function a(e){r(s,o,i,a,c,"next",e)}function c(e){r(s,o,i,a,c,"throw",e)}a(void 0)}))}}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function r(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.should_show=!1,this.is_confirmed=!1,this.last_location=null,this.current_location=null,(0,e.makeObservable)(this,{should_show:e.observable,is_confirmed:e.observable,last_location:e.observable,current_location:e.observable,shouldNavigateAfterPrompt:e.action.bound,resetLastLocation:e.action.bound,resetIsConfirmed:e.action.bound,onConfirm:e.action.bound,onCancel:e.action.bound,continueRoute:e.action.bound}),this.root_store=t}var i,s,a,c;return i=r,s=[{key:"shouldNavigateAfterPrompt",value:function(e,t){this.is_confirmed||(this.last_location=e,this.should_show=!0,this.current_location=t)}},{key:"resetLastLocation",value:function(){this.last_location=null}},{key:"resetIsConfirmed",value:function(){this.is_confirmed=!1}},{key:"onConfirm",value:(c=n(regeneratorRuntime.mark((function e(){var r,n,o,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.root_store,n=r.client,o=r.modules,i=o.cashier.account_transfer.accounts_list,this.should_show=!1,this.is_confirmed=!0,s=i.some((function(e){return!e.is_crypto})),!(0,t.isCryptocurrency)(null==n?void 0:n.currency)||!s){e.next=8;break}return e.next=8,this.doSwitch();case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"doSwitch",value:(a=n(regeneratorRuntime.mark((function e(){var t,r,n,o,i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store,r=t.client,n=t.modules,o=n.cashier,i=o.account_transfer,s=o.general_store,a=i.accounts_list.filter((function(e){return!e.is_crypto})),c=a.map((function(e){return e.value}))[0],e.next=6,r.switchAccount(c);case 6:"deposit"===this.current_location&&s.setIsDeposit(!0);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onCancel",value:function(){this.should_show=!1}},{key:"continueRoute",value:function(){this.is_confirmed&&this.last_location&&this.root_store.common.routeTo(this.last_location)}}],s&&o(i.prototype,s),Object.defineProperty(i,"prototype",{writable:!1}),r}(),s=h("react"),a=h.n(s),c=h("@deriv/translations");const u={containers:{account_transfer:"account_transfer",deposit:"deposit",payment_agent:"payment_agent",payment_agent_transfer:"payment_agent_transfer",withdraw:"withdraw"},map_action:{withdraw:"payment_withdraw",payment_agent:"payment_agent_withdraw"}};function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.message="",this.code="",this.fields="",this.is_show_full_page=!1,this.onClickButton=null,this.is_ask_uk_funds_protection=!1,this.is_self_exclusion_max_turnover_set=!1,this.is_ask_authentication=!1,this.is_ask_financial_risk_approval=!1,(0,e.makeObservable)(this,{message:e.observable,code:e.observable,fields:e.observable,is_show_full_page:e.observable,onClickButton:e.observable,is_ask_uk_funds_protection:e.observable,is_self_exclusion_max_turnover_set:e.observable,is_ask_authentication:e.observable,is_ask_financial_risk_approval:e.observable,setErrorMessage:e.action.bound,handleCashierError:e.action.bound,setMessage:e.action.bound,setIsAskUkFundsProtection:e.action.bound,setIsSelfExclusionMaxTurnoverSet:e.action.bound,setIsAskAuthentication:e.action.bound,setIsAskFinancialRiskApproval:e.action.bound})}var n,o;return n=r,o=[{key:"setErrorMessage",value:function(e,r,n){var o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({onClickButton:r,code:e.code,message:e.message,is_show_full_page:n||/InvalidToken|WrongResponse/.test(e.code)},(0,t.getPropertyValue)(e,["details","fields"])&&{fields:e.details.fields});this.onClickButton=o.onClickButton,this.code=o.code,this.message=o.message,this.is_show_full_page=o.is_show_full_page,this.fields=o.fields,this.is_ask_uk_funds_protection=null==o?void 0:o.is_ask_uk_funds_protection,this.is_self_exclusion_max_turnover_set=null==o?void 0:o.is_self_exclusion_max_turnover_set,this.is_ask_authentication=null==o?void 0:o.is_ask_authentication,this.is_ask_financial_risk_approval=null==o?void 0:o.is_ask_financial_risk_approval}},{key:"handleCashierError",value:function(e){switch(e.code){case"ASK_TNC_APPROVAL":case"ASK_FIX_DETAILS":this.setErrorMessage(e,null,!0);break;case"ASK_UK_FUNDS_PROTECTION":this.setIsAskUkFundsProtection(!0);break;case"ASK_SELF_EXCLUSION_MAX_TURNOVER_SET":this.setIsSelfExclusionMaxTurnoverSet(!0);break;case"ASK_AUTHENTICATE":case"ASK_AGE_VERIFICATION":this.setIsAskAuthentication(!0);break;case"ASK_FINANCIAL_RISK_APPROVAL":this.setIsAskFinancialRiskApproval(!0);break;default:this.setErrorMessage(e),this.setIsAskUkFundsProtection(!1),this.setIsSelfExclusionMaxTurnoverSet(!1),this.setIsAskAuthentication(!1),this.setIsAskFinancialRiskApproval(!1)}}},{key:"setMessage",value:function(e){this.message=e}},{key:"setIsAskUkFundsProtection",value:function(e){this.is_ask_uk_funds_protection=e}},{key:"setIsSelfExclusionMaxTurnoverSet",value:function(e){this.is_self_exclusion_max_turnover_set=e}},{key:"setIsAskAuthentication",value:function(e){this.is_ask_authentication=e}},{key:"setIsAskFinancialRiskApproval",value:function(e){this.is_ask_financial_risk_approval=e}}],o&&_(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),r}();function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function k(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){w(i,n,o,s,a,"next",e)}function a(e){w(i,n,o,s,a,"throw",e)}s(void 0)}))}}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var S=function(e){return e.startsWith("MX")},T=function(e,t){return t?a().createElement(c.Localize,{i18n_default_text:"Transfer from {{selected_value}} is not allowed, Please choose another account from dropdown",values:{selected_value:e}}):a().createElement(c.Localize,{i18n_default_text:"Transfer to {{selected_value}} is not allowed, Please choose another account from dropdown",values:{selected_value:e}})},A=function(){function r(n){var o=this,i=n.WS,s=n.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.accounts_list=[],this.container=u.containers.account_transfer,this.error=new p,this.has_no_account=!1,this.has_no_accounts_balance=!1,this.is_transfer_confirm=!1,this.is_transfer_successful=!1,this.is_mt5_transfer_in_progress=!1,this.minimum_fee=null,this.receipt={},this.selected_from={},this.selected_to={},this.account_transfer_amount="",this.transfer_fee=null,this.transfer_limit={},this.requestTransferBetweenAccounts=function(){var e=k(regeneratorRuntime.mark((function e(r){var n,i,s,a,c,u,l,h,d,f,_,p,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.amount,i=o.root_store,s=i.client,a=i.modules,c=a.cashier.general_store.setLoading,u=s.is_logged_in,l=s.responseMt5LoginList,h=s.responseTradingPlatformAccountsList,d=s.setAccountStatus,f=s.setBalanceOtherAccounts,u){e.next=6;break}return e.abrupt("return",null);case 6:return c(!0),o.error.setErrorMessage(""),(_=o.selected_from.is_mt||o.selected_to.is_mt)&&o.setIsMT5TransferInProgress(!0),p=o.selected_from.currency,e.next=13,o.WS.authorized.transferBetweenAccounts(o.selected_from.value,o.selected_to.value,p,n);case 13:if(m=e.sent,_&&o.setIsMT5TransferInProgress(!1),!m.error){e.next=24;break}if("Fiat2CryptoTransferOverLimit"!==m.error.code){e.next=21;break}return e.next=19,o.WS.authorized.getAccountStatus();case 19:(v=e.sent).error||d(v.get_account_status);case 21:o.error.setErrorMessage(m.error),e.next=28;break;case 24:o.setReceiptTransfer({amount:(0,t.formatMoney)(p,n,!0)}),m.accounts.forEach((function(e){o.setBalanceByLoginId(e.loginid,e.balance),e.loginid===o.selected_from.value?o.setBalanceSelectedFrom(e.balance):e.loginid===o.selected_to.value&&o.setBalanceSelectedTo(e.balance),e.account_type===t.CFD_PLATFORMS.MT5&&Promise.all([o.WS.mt5LoginList(),o.WS.balanceAll()]).then((function(e){var t=b(e,2),r=t[0],n=t[1];l(r),f(n.balance)})),e.account_type===t.CFD_PLATFORMS.DXTRADE&&Promise.all([o.WS.tradingPlatformAccountsList(t.CFD_PLATFORMS.DXTRADE),o.WS.balanceAll()]).then((function(e){var t=b(e,2),r=t[0],n=t[1];h(r),f(n.balance)}))})),o.setAccountTransferAmount(null),o.setIsTransferConfirm(!0);case 28:return c(!1),e.abrupt("return",m);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.resetAccountTransfer=k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.setIsTransferConfirm(!1),o.setTransferLimit();case 2:case"end":return e.stop()}}),e)}))),(0,e.makeObservable)(this,{accounts_list:e.observable,container:e.observable,error:e.observable,has_no_account:e.observable,has_no_accounts_balance:e.observable,is_transfer_confirm:e.observable,is_transfer_successful:e.observable,is_mt5_transfer_in_progress:e.observable,minimum_fee:e.observable,receipt:e.observable,selected_from:e.observable,selected_to:e.observable,account_transfer_amount:e.observable,transfer_fee:e.observable,transfer_limit:e.observable,is_account_transfer_visible:e.computed,is_transfer_locked:e.computed,setBalanceByLoginId:e.action.bound,setBalanceSelectedFrom:e.action.bound,setBalanceSelectedTo:e.action.bound,onMountAccountTransfer:e.action.bound,setHasNoAccountsBalance:e.action.bound,setHasNoAccount:e.action.bound,setTransferFee:e.action.bound,setMinimumFee:e.action.bound,setTransferLimit:e.action.bound,sortAccountsTransfer:e.action.bound,setSelectedFrom:e.action.bound,setSelectedTo:e.action.bound,setAccounts:e.action.bound,setIsTransferConfirm:e.action.bound,setAccountTransferAmount:e.action.bound,setIsTransferSuccessful:e.action.bound,setIsMT5TransferInProgress:e.action.bound,setReceiptTransfer:e.action.bound,onChangeTransferFrom:e.action.bound,onChangeTransferTo:e.action.bound,resetAccountTransfer:e.action.bound,setTransferPercentageSelectorResult:e.action.bound,validateTransferFromAmount:e.action.bound,validateTransferToAmount:e.action.bound}),this.root_store=s,this.WS=i}var n,o,i,s;return n=r,o=[{key:"is_account_transfer_visible",get:function(){var e=this.root_store.client,t=e.has_maltainvest_account,r=e.landing_company_shortcode;return"im"!==e.residence&&("malta"!==r||t)}},{key:"is_transfer_locked",get:function(){var e=this.root_store.client,t=e.is_financial_account,r=e.is_financial_information_incomplete,n=e.is_trading_experience_incomplete;return!!e.account_status.status&&t&&(r||n)&&this.error.is_ask_financial_risk_approval}},{key:"setBalanceByLoginId",value:function(e,t){this.accounts_list.find((function(t){return e===t.value})).balance=t}},{key:"setBalanceSelectedFrom",value:function(e){this.selected_from.balance=e}},{key:"setBalanceSelectedTo",value:function(e){this.selected_to.balance=e}},{key:"onMountAccountTransfer",value:(s=k(regeneratorRuntime.mark((function e(){var t,r,n,o,i,s,a,c,u,l,h,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store,r=t.client,n=t.modules,o=n.cashier.general_store,i=o.onMountCommon,s=o.setLoading,a=o.setOnRemount,c=r.active_accounts,u=r.is_logged_in,s(!0),a(this.onMountAccountTransfer),e.next=7,i();case 7:return e.next=9,this.WS.wait("website_status");case 9:if(this.has_no_accounts_balance&&Object.keys(c).find((function(e){return!c[e].is_virtual&&c[e].balance}))&&this.setHasNoAccountsBalance(!1),!u){e.next=27;break}return e.next=14,this.WS.authorized.transferBetweenAccounts();case 14:if(!(h=e.sent).error){e.next=19;break}return this.error.setErrorMessage(h.error,this.onMountAccountTransfer),s(!1),e.abrupt("return");case 19:if(this.canDoAccountTransfer(h.accounts)){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,this.sortAccountsTransfer(h);case 23:this.setTransferFee(),this.setMinimumFee(),this.setTransferLimit(),(null===(l=this.accounts_list)||void 0===l?void 0:l.length)>0&&(d=sessionStorage.getItem("cfd_transfer_to_login_id"),sessionStorage.removeItem("cfd_transfer_to_login_id"),(f=this.accounts_list.find((function(e){return e.value===d})))&&(S(f.value)&&(f.error=T(f.value)),this.setSelectedTo(f)));case 27:s(!1);case 28:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"canDoAccountTransfer",value:function(e){var t=!0;return e.find((function(e){return+e.balance>0}))?this.setHasNoAccountsBalance(!1):(t=!1,this.setHasNoAccountsBalance(!0)),e.length<=1?(t=!1,this.setHasNoAccount(!0)):this.setHasNoAccount(!1),t||this.root_store.modules.cashier.general_store.setLoading(!1),t}},{key:"setHasNoAccountsBalance",value:function(e){this.has_no_accounts_balance=e}},{key:"setHasNoAccount",value:function(e){this.has_no_account=e}},{key:"setTransferFee",value:function(){var e=(0,t.getPropertyValue)((0,t.getCurrencies)(),[this.selected_from.currency,"transfer_between_accounts","fees",this.selected_to.currency]);this.transfer_fee=Number(e||0)}},{key:"setMinimumFee",value:function(){var e=(0,t.getDecimalPlaces)(this.selected_from.currency);this.minimum_fee=(1/Math.pow(10,e)).toFixed(e)}},{key:"setTransferLimit",value:function(){var e,r=this.selected_from.is_mt||this.selected_to.is_mt,n=this.selected_from.is_dxtrade||this.selected_to.is_dxtrade;e=r?"limits_mt5":n?"limits_dxtrade":"limits";var o=(0,t.getPropertyValue)((0,t.getCurrencies)(),[this.selected_from.currency,"transfer_between_accounts",e]),i=this.selected_from.balance,s=(0,t.getDecimalPlaces)(this.selected_from.currency);this.transfer_limit={max:null==o||!o.max||+i>=((null==o?void 0:o.min)||0)&&+i<=(null==o?void 0:o.max)?i:null==o?void 0:o.max.toFixed(s),min:null!=o&&o.min?(+(null==o?void 0:o.min)).toFixed(s):null}}},{key:"sortAccountsTransfer",value:(i=k(regeneratorRuntime.mark((function e(r){var n,o,i,s,a,c,u,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r,e.t0){e.next=5;break}return e.next=4,this.WS.authorized.transferBetweenAccounts();case 4:e.t0=e.sent;case 5:if(i=e.t0,this.accounts_list.length){e.next=9;break}if(!i.error){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.WS.storage.mt5LoginList();case 11:if(e.t2=n=e.sent,e.t1=null===e.t2,e.t1){e.next=15;break}e.t1=void 0===n;case 15:if(!e.t1){e.next=19;break}e.t3=void 0,e.next=20;break;case 19:e.t3=n.mt5_login_list;case 20:return s=e.t3,e.next=23,this.WS.tradingPlatformAccountsList(t.CFD_PLATFORMS.DXTRADE);case 23:if(e.t5=o=e.sent,e.t4=null===e.t5,e.t4){e.next=27;break}e.t4=void 0===o;case 27:if(!e.t4){e.next=31;break}e.t6=void 0,e.next=32;break;case 31:e.t6=o.trading_platform_accounts;case 32:a=e.t6,c=i.accounts.map((function(e){if(e.account_type===t.CFD_PLATFORMS.MT5&&Array.isArray(s)&&s.length){var r=s.find((function(t){return t.login===e.loginid}));return void 0===r?e:v(v(v({},e),r),{},{account_type:t.CFD_PLATFORMS.MT5})}if(e.account_type===t.CFD_PLATFORMS.DXTRADE&&Array.isArray(a)&&a.length){var n=a.find((function(t){return t.account_id===e.loginid}));return void 0===n?e:v(v(v({},e),n),{},{account_type:t.CFD_PLATFORMS.DXTRADE})}return e})),i.accounts.length>1&&c.sort((function(e,r){var n=e.account_type===t.CFD_PLATFORMS.MT5,o=r.account_type===t.CFD_PLATFORMS.MT5,i=!n&&(0,t.isCryptocurrency)(e.currency),s=!o&&(0,t.isCryptocurrency)(r.currency),a=!n&&!i,c=!o&&!s;return n&&o?"gaming"===e.market_type||"synthetic"===e.market_type?-1:"financial"===e.sub_account_type?"gaming"===r.market_type||"synthetic"===r.market_type?1:-1:1:i&&s||a&&c?e.currency<r.currency?-1:1:i&&o||a&&s||a&&o||n?-1:1})),u=[],this.setSelectedTo({}),c.forEach((function(e){var r,n,o={mt5:{name:"DMT5",icon:"IcMt5"},dxtrade:{name:"Deriv X",icon:"IcDxtrade"}},i=Object.keys(o).includes(e.account_type),s=null===(r=o[e.account_type])||void 0===r?void 0:r.name,a="".concat(null===(n=o[e.account_type])||void 0===n?void 0:n.icon,"-").concat((0,t.getCFDAccount)({market_type:e.market_type,sub_account_type:e.sub_account_type,platform:e.account_type,is_eu:l.root_store.client.is_eu})),c=v({text:i?"".concat(s," ").concat((0,t.getCFDAccountDisplay)({market_type:e.market_type,sub_account_type:e.sub_account_type,platform:e.account_type,is_eu:l.root_store.client.is_eu})):(0,t.getCurrencyDisplayCode)("eUSDT"!==e.currency?e.currency.toUpperCase():e.currency),value:e.loginid,balance:e.balance,currency:e.currency,is_crypto:(0,t.isCryptocurrency)(e.currency),is_mt:e.account_type===t.CFD_PLATFORMS.MT5,is_dxtrade:e.account_type===t.CFD_PLATFORMS.DXTRADE},i&&{platform_icon:a,market_type:(0,t.getCFDAccount)({market_type:e.market_type,sub_account_type:e.sub_account_type,platform:e.account_type,is_eu:l.root_store.client.is_eu})});e.loginid===l.root_store.client.loginid?(S(c.value)&&(c.error=T(c.value,!0)),l.setSelectedFrom(c)):(0,t.isEmptyObject)(l.selected_to)&&(S(c.value)&&(c.error=T(c.value)),l.setSelectedTo(c)),u.push(c)})),this.setAccounts(u);case 39:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setSelectedFrom",value:function(e){this.selected_from=e}},{key:"setSelectedTo",value:function(e){this.selected_to=e}},{key:"setAccounts",value:function(e){this.accounts_list=e}},{key:"setIsTransferConfirm",value:function(e){this.is_transfer_confirm=e}},{key:"setAccountTransferAmount",value:function(e){this.account_transfer_amount=e}},{key:"setIsTransferSuccessful",value:function(e){this.is_transfer_successful=e}},{key:"setIsMT5TransferInProgress",value:function(e){this.is_mt5_transfer_in_progress=e}},{key:"setReceiptTransfer",value:function(e){var t=e.amount;this.receipt={amount_transferred:t}}},{key:"onChangeTransferFrom",value:function(e){var t=e.target;this.error.setErrorMessage(""),this.selected_from.error="";var r=this.accounts_list.find((function(e){return e.value===t.value}));if(r.value===this.selected_to.value)this.onChangeTransferTo({target:{value:this.selected_from.value}});else if(r.is_mt&&this.selected_to.is_mt||r.is_dxtrade&&this.selected_to.is_dxtrade||r.is_dxtrade&&this.selected_to.is_mt||r.is_mt&&this.selected_to.is_dxtrade){var n=this.accounts_list.find((function(e){return!e.is_mt&&!e.is_dxtrade}));this.onChangeTransferTo({target:{value:n.value}})}S(r.value)&&(r.error=T(r.value,!0)),this.selected_from=r,this.setTransferFee(),this.setMinimumFee(),this.setTransferLimit()}},{key:"onChangeTransferTo",value:function(e){var t=e.target;this.error.setErrorMessage(""),this.selected_to.error="";var r=this.accounts_list;this.selected_to=r.find((function(e){return e.value===t.value}))||{},S(this.selected_to.value)&&(this.selected_to.error=T(this.selected_to.value)),this.setTransferFee(),this.setMinimumFee(),this.setTransferLimit()}},{key:"setTransferPercentageSelectorResult",value:function(e){var t=this.root_store.modules.cashier,r=t.crypto_fiat_converter,n=t.general_store,o=this.selected_from.currency,i=this.selected_to.currency;e>0||0==+this.selected_from.balance?(r.setConverterFromAmount(e),this.validateTransferFromAmount(),r.onChangeConverterFromAmount({target:{value:e}},o,i)):r.resetConverter(),r.setIsTimerVisible(!1),n.percentageSelectorSelectionStatus(!1)}},{key:"validateTransferFromAmount",value:function(){var e=this.root_store.modules.cashier.crypto_fiat_converter,r=e.converter_from_amount,n=e.setConverterFromError;if(r){var o=(0,t.validNumber)(r,{type:"float",decimals:(0,t.getDecimalPlaces)(this.selected_from.currency),min:this.transfer_limit.min,max:this.transfer_limit.max}),i=o.is_ok,s=o.message;i?+this.selected_from.balance<+r?n((0,c.localize)("Insufficient funds")):n(""):n(s)}else n((0,c.localize)("This field is required."))}},{key:"validateTransferToAmount",value:function(){var e=this.root_store.modules.cashier.crypto_fiat_converter,r=e.converter_to_amount,n=e.setConverterToError;if(r){var o=this.selected_to.currency,i=(0,t.validNumber)(r,{type:"float",decimals:(0,t.getDecimalPlaces)(o)}),s=i.is_ok,a=i.message;n(s?"":a)}}}],o&&C(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),r}();function P(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function x(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){P(i,n,o,s,a,"next",e)}function a(e){P(i,n,o,s,a,"throw",e)}s(void 0)}))}}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var O=function(){function r(t){var n=t.WS,o=t.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.converter_from_amount="",this.converter_to_amount="",this.converter_from_error="",this.converter_to_error="",this.is_timer_visible=!1,(0,e.makeObservable)(this,{converter_from_amount:e.observable,converter_to_amount:e.observable,converter_from_error:e.observable,converter_to_error:e.observable,is_timer_visible:e.observable,setConverterFromAmount:e.action.bound,setConverterToAmount:e.action.bound,setConverterFromError:e.action.bound,setConverterToError:e.action.bound,setIsTimerVisible:e.action.bound,resetTimer:e.action.bound,getExchangeRate:e.action.bound,validateFromAmount:e.action.bound,validateToAmount:e.action.bound,onChangeConverterFromAmount:e.action.bound,onChangeConverterToAmount:e.action.bound,resetConverter:e.action.bound}),this.root_store=o,this.WS=n}var n,o,i,s,a;return n=r,o=[{key:"setConverterFromAmount",value:function(e){this.converter_from_amount=e}},{key:"setConverterToAmount",value:function(e){this.converter_to_amount=e}},{key:"setConverterFromError",value:function(e){this.converter_from_error=e}},{key:"setConverterToError",value:function(e){this.converter_to_error=e}},{key:"setIsTimerVisible",value:function(e){this.is_timer_visible=e}},{key:"resetTimer",value:function(){this.setIsTimerVisible(!1)}},{key:"getExchangeRate",value:(a=x(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.send({exchange_rates:1,base_currency:t});case 2:return n=e.sent,o=n.exchange_rates,e.abrupt("return",o.rates[r]);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"validateFromAmount",value:function(){var e=this.root_store.modules.cashier,t=e.account_transfer,r=e.general_store,n=e.withdraw;r.active_container===t.container?t.validateTransferFromAmount():n.validateWithdrawFromAmount()}},{key:"validateToAmount",value:function(){var e=this.root_store.modules.cashier,t=e.account_transfer,r=e.general_store,n=e.withdraw;r.active_container===t.container?t.validateTransferToAmount():n.validateWithdrawToAmount()}},{key:"onChangeConverterFromAmount",value:(s=x(regeneratorRuntime.mark((function e(r,n,o){var i,s,a,c,u,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.target,s=this.root_store.modules.cashier,a=s.account_transfer,c=s.general_store,this.resetTimer(),!i.value){e.next=27;break}if(this.setConverterFromAmount(i.value),this.validateFromAmount(),c.percentageSelectorSelectionStatus(!0),c.calculatePercentage(),!this.converter_from_error){e.next=15;break}this.setConverterToAmount(""),this.setConverterToError(""),this.setIsTimerVisible(!1),a.setAccountTransferAmount(""),e.next=25;break;case 15:return e.next=17,this.getExchangeRate(n,o);case 17:u=e.sent,l=(0,t.getDecimalPlaces)(o),+(h=(u*i.value).toFixed(l))||this.converter_from_amount?this.setConverterToAmount(h):this.setConverterToAmount(""),this.validateToAmount(),this.setConverterToError(""),this.setIsTimerVisible(!0),a.setAccountTransferAmount(i.value);case 25:e.next=28;break;case 27:this.resetConverter();case 28:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"onChangeConverterToAmount",value:(i=x(regeneratorRuntime.mark((function e(r,n,o){var i,s,a,c,u,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.target,s=this.root_store.modules.cashier,a=s.account_transfer,c=s.general_store,this.resetTimer(),!i.value){e.next=25;break}if(this.setConverterToAmount(i.value),this.validateToAmount(),!this.converter_to_error){e.next=13;break}this.setConverterFromAmount(""),this.setConverterFromError(""),this.setIsTimerVisible(!1),a.setAccountTransferAmount(""),e.next=23;break;case 13:return e.next=15,this.getExchangeRate(n,o);case 15:u=e.sent,l=(0,t.getDecimalPlaces)(o),+(h=(u*i.value).toFixed(l))||this.converter_to_amount?this.setConverterFromAmount(h):this.setConverterFromAmount(""),c.percentageSelectorSelectionStatus(!0),c.calculatePercentage(),this.validateFromAmount(),this.converter_from_error?(this.setIsTimerVisible(!1),a.setAccountTransferAmount("")):(this.setConverterFromError(""),this.setIsTimerVisible(!0),a.setAccountTransferAmount(h));case 23:e.next=26;break;case 25:this.resetConverter();case 26:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"resetConverter",value:function(){this.setConverterFromAmount(""),this.setConverterToAmount(""),this.setConverterFromError(""),this.setConverterToError(""),this.setIsTimerVisible(!1),this.root_store.modules.cashier.general_store.percentageSelectorSelectionStatus(!0)}}],o&&I(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),r}();function R(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var D=function(){function t(r){var n=r.WS,o=r.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=u.containers.deposit,this.error=new p,(0,e.makeObservable)(this,{container:e.observable,error:e.observable,onMountDeposit:e.action.bound,is_deposit_locked:e.computed,submitFundsProtection:e.action.bound}),this.root_store=o,this.WS=n}var r,n,o,i;return r=t,n=[{key:"onMountDeposit",value:(o=regeneratorRuntime.mark((function e(){var t,r,n,o,i,s,a,c,u,l,h,d,f,_,p,m,v,y,b,g,w,k,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.root_store,n=r.client,o=r.modules,i=o.cashier.general_store,s=i.active_container,a=i.is_crypto,c=i.onMountCommon,u=i.setLoading,l=i.setOnRemount,h=o.cashier.iframe,d=h.checkIframeLoaded,f=h.clearTimeoutCashierUrl,_=h.is_session_timeout,p=h.setContainerHeight,m=h.setIframeUrl,v=h.setSessionTimeout,y=h.setTimeoutCashierUrl,b=n.account_status,g=n.is_virtual,w=n.updateAccountStatus,k=s,l(this.onMountDeposit),e.next=8,c();case 8:if(this.error.setErrorMessage(""),p(0),u(!0),_){e.next=14;break}return d(),e.abrupt("return");case 14:if(m(""),!g){e.next=18;break}return u(!1),e.abrupt("return");case 18:if(a){e.next=36;break}return e.next=21,this.WS.authorized.cashier(s,{verification_code:"undefined"});case 21:if(C=e.sent,k===s){e.next=25;break}return u(!1),e.abrupt("return");case 25:if(!C.error){e.next=31;break}this.error.handleCashierError(C.error),v(!0),f(),e.next=36;break;case 31:return e.next=33,d();case 33:m(C.cashier),v(!1),y();case 36:if(null!=b&&null!==(t=b.status)&&void 0!==t&&t.includes("deposit_attempt")){e.next=39;break}return e.next=39,w();case 39:u(!1);case 40:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function s(e){R(i,r,n,s,a,"next",e)}function a(e){R(i,r,n,s,a,"throw",e)}s(void 0)}))},function(){return i.apply(this,arguments)})},{key:"is_deposit_locked",get:function(){var e=this.root_store.client,t=e.is_authentication_needed,r=e.is_tnc_needed,n=e.is_financial_account,o=e.is_financial_information_incomplete,i=e.is_trading_experience_incomplete,s=e.account_status,a=e.is_eu,c=e.mt5_login_list,u=e.is_deposit_lock;if(null==s||!s.status)return!1;var l=this.error.is_ask_authentication||t&&a,h=n&&(o||i),d=(a||c.some((function(e){return"real"===e.account_type&&"financial_stp"===e.sub_account_type})))&&r;return u||l||d||h||this.error.is_ask_financial_risk_approval}},{key:"submitFundsProtection",value:function(){var e=this;this.WS.send({ukgc_funds_protection:1,tnc_approval:1}).then((function(t){t.error?e.error.setMessage(t.error.message):location.reload()}))}}],n&&E(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var L=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.confirm_button_text="",this.error_message="",this.has_no_close_icon=!1,this.should_show=!1,this.should_not_show_title=!1,(0,e.makeObservable)(this,{confirm_button_text:e.observable,error_message:e.observable,has_no_close_icon:e.observable,should_show:e.observable,should_not_show_title:e.observable,setShouldShow:e.action.bound,setErrorMessage:e.action.bound,setConfirmButtonText:e.action.bound,setShouldNotShowTitle:e.action.bound,setHasNoCloseIcon:e.action.bound,openReadMoreDialog:e.action.bound,reset:e.action.bound})}var r,n;return r=t,(n=[{key:"setShouldShow",value:function(e){this.should_show=e}},{key:"setErrorMessage",value:function(e){this.error_message=e,this.setShouldShow(!0)}},{key:"setConfirmButtonText",value:function(e){this.confirm_button_text=e}},{key:"setShouldNotShowTitle",value:function(e){this.should_not_show_title=e}},{key:"setHasNoCloseIcon",value:function(e){this.has_no_close_icon=e}},{key:"openReadMoreDialog",value:function(e,t){this.setErrorMessage(e),this.setConfirmButtonText(t),this.setHasNoCloseIcon(!0),this.setShouldNotShowTitle(!0)}},{key:"reset",value:function(){this.setConfirmButtonText(""),this.setShouldNotShowTitle(!1),this.setHasNoCloseIcon(!1)}}])&&M(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}(),W=h("../../../node_modules/prop-types/index.js"),j=h.n(W),F=h("@deriv/components"),V=function(e){var t=e.p2p_notification_count;return a().createElement(a().Fragment,null,a().createElement(F.Icon,{icon:"IcCashier",className:"header__icon"}),!!t&&a().createElement(F.Counter,{className:"cashier__counter",count:t}))};V.propTypes={p2p_notification_count:j().number};const B=V;var N=function(e,t){var r=t;return t&&!Array.isArray(t)&&(r=[t]),e.replace(/\[_(\d+)]/g,(function(e,t){return r[+t-1]}))};function H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var U=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors={}}return function(e,t,r){t&&H(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"add",value:function(e,t){this.has(e)||(this.errors[e]=[]),-1===this.errors[e].indexOf(t)&&this.errors[e].push(t)}},{key:"all",value:function(){return this.errors}},{key:"first",value:function(e){return this.has(e)?this.errors[e][0]:null}},{key:"get",value:function(e){return this.has(e)?this.errors[e]:[]}},{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.errors,e)}}]),e}();const q=U;function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var X=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;z(this,e),this.input=t,this.rules=r,this.store=n,this.errors=new q,this.error_count=0}return function(e,t,r){t&&G(e.prototype,t),r&&G(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"addFailure",value:function(e,r,n){var o=n||r.options.message||(0,t.getPreBuildDVRs)()[r.name].message();"length"===r.name?o=N(o,[r.options.min===r.options.max?r.options.min:"".concat(r.options.min,"-").concat(r.options.max)]):"min"===r.name?o=N(o,[r.options.min]):"not_equal"===r.name&&(o=N(o,[r.options.name1,r.options.name2])),this.errors.add(e,o),this.error_count++}},{key:"check",value:function(){var t=this;return Object.keys(this.input).forEach((function(r){Object.prototype.hasOwnProperty.call(t.rules,r)&&t.rules[r].forEach((function(n){var o=e.getRuleObject(n);if((o.validator||"function"==typeof o.validator)&&(!o.options.condition||o.options.condition(t.store))&&(""!==t.input[r]||"req"===o.name)){var i,s;if("number"===o.name){var a=o.validator(t.input[r],o.options,t.store,t.input);i=a.is_ok,s=a.message}else i=o.validator(t.input[r],o.options,t.store,t.input);i||t.addFailure(r,o,s)}}))})),!this.error_count}},{key:"isPassed",value:function(){return this.check()}}],[{key:"getRuleObject",value:function(e){var r="string"==typeof e,n={name:r?e:e[0],options:r?{}:e[1]||{}};return n.validator="custom"===n.name?e[1].func:(0,t.getPreBuildDVRs)()[n.name].func,n}}]),e}();const K=X;function J(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function Y(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){J(i,n,o,s,a,"next",e)}function a(e){J(i,n,o,s,a,"throw",e)}s(void 0)}))}}function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){Z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var re=function(){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ee(this,r),this.validation_errors={},this.validation_rules={},this.preSwitchAccountDisposer=null,this.pre_switch_account_listener=null,this.switchAccountDisposer=null,this.switch_account_listener=null,this.logoutDisposer=null,this.logout_listener=null,this.clientInitDisposer=null,this.client_init_listener=null,this.networkStatusChangeDisposer=null,this.network_status_change_listener=null,this.themeChangeDisposer=null,this.theme_change_listener=null,this.realAccountSignupEndedDisposer=null,this.real_account_signup_ended_listener=null,this.partial_fetch_time=0,(0,e.makeObservable)(this,{validation_errors:e.observable,validation_rules:e.observable,partial_fetch_time:e.observable,retrieveFromStorage:e.action,setValidationErrorMessages:e.action,setValidationRules:e.action,addRule:e.action,validateProperty:e.action,validateAllProperties:e.action,onSwitchAccount:e.action.bound,onPreSwitchAccount:e.action.bound,onLogout:e.action.bound,onClientInit:e.action.bound,onNetworkStatusChange:e.action.bound,onThemeChange:e.action.bound,onRealAccountSignupEnd:e.action.bound,disposePreSwitchAccount:e.action.bound,disposeSwitchAccount:e.action.bound,disposeLogout:e.action.bound,disposeClientInit:e.action.bound,disposeNetworkStatusChange:e.action.bound,disposeThemeChange:e.action.bound,disposeRealAccountSignupEnd:e.action.bound,onUnmount:e.action.bound,assertHasValidCache:e.action.bound});var n=t.root_store,o=t.local_storage_properties,i=t.session_storage_properties,s=t.validation_rules,a=t.store_name;Object.defineProperty(this,"root_store",{enumerable:!1,writable:!0}),Object.defineProperty(this,"local_storage_properties",{enumerable:!1,writable:!0}),Object.defineProperty(this,"session_storage_properties",{enumerable:!1,writable:!0});var c=o&&o.length||i&&i.length;if(c){if(!a)throw new Error("store_name is required for local/session storage");Object.defineProperty(this,"store_name",{value:a,enumerable:!1,writable:!1})}this.root_store=n,this.local_storage_properties=o||[],this.session_storage_properties=i||[],this.setValidationRules(s),this.setupReactionForLocalStorage(),this.setupReactionForSessionStorage(),this.retrieveFromStorage()}return function(e,t,r){t&&te(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"getSnapshot",value:function(r){var n=(0,e.toJS)(this);return(0,t.isEmptyObject)(this.root_store)||(n.root_store=this.root_store),r&&r.length&&(n=r.reduce((function(e,t){return Object.assign(e,Z({},t,n[t]))}),{})),n}},{key:"setupReactionForLocalStorage",value:function(){var t=this;this.local_storage_properties.length&&(0,e.reaction)((function(){return t.local_storage_properties.map((function(e){return t[e]}))}),(function(){return t.saveToStorage(t.local_storage_properties,r.STORAGES.LOCAL_STORAGE)}))}},{key:"setupReactionForSessionStorage",value:function(){var t=this;this.session_storage_properties.length&&(0,e.reaction)((function(){return t.session_storage_properties.map((function(e){return t[e]}))}),(function(){return t.saveToStorage(t.session_storage_properties,r.STORAGES.SESSION_STORAGE)}))}},{key:"saveToStorage",value:function(e,t){var n=JSON.stringify(this.getSnapshot(e),(function(e,t){if(null!==t)return t}));t===r.STORAGES.LOCAL_STORAGE?localStorage.setItem(this.store_name,n):t===r.STORAGES.SESSION_STORAGE&&sessionStorage.setItem(this.store_name,n)}},{key:"retrieveFromStorage",value:function(){var e=this,t=JSON.parse(localStorage.getItem(this.store_name,{})),r=JSON.parse(sessionStorage.getItem(this.store_name,{})),n=Q(Q({},t),r);Object.keys(n).forEach((function(t){return e[t]=n[t]}))}},{key:"setValidationErrorMessages",value:function(e,t){var r=this;this.validation_errors[e]&&!r.validation_errors[e].filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!r.validation_errors[e].includes(t)}))).length||(this.validation_errors[e]=t)}},{key:"setValidationRules",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach((function(r){e.addRule(r,t[r])}))}},{key:"addRule",value:function(t,r){var n=this;this.validation_rules[t]=r,(0,e.intercept)(this,t,(function(e){return n.validateProperty(t,e.newValue),e}))}},{key:"validateProperty",value:function(e,t){var r=this,n=this.validation_rules[e].trigger,o=Z({},e,void 0!==t?t:this[e]),i=Z({},e,this.validation_rules[e].rules||[]);n&&Object.hasOwnProperty.call(this,n)&&(o[n]=this[n],i[n]=this.validation_rules[n].rules||[]);var s=new K(o,i,this);s.isPassed(),Object.keys(o).forEach((function(e){r.setValidationErrorMessages(e,s.errors.get(e))}))}},{key:"validateAllProperties",value:function(){var e=this,t=Object.keys(this.validation_rules),r=Object.keys(this.validation_errors);t.forEach((function(t){e.validateProperty(t,e[t])})),r.forEach((function(r){t.includes(r)||delete e.validation_errors[r]}))}},{key:"onSwitchAccount",value:function(r){var n=this;r&&(this.switch_account_listener=r,this.switchAccountDisposer=(0,e.when)((function(){return n.root_store.client.switch_broadcast}),(function(){try{var e=n.switch_account_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Switching account listeners are required to return a promise.");e.then((function(){n.root_store.client.switchEndSignal(),n.onSwitchAccount(n.switch_account_listener)}))}catch(e){(0,t.isProduction)()||console.error(e)}})))}},{key:"onPreSwitchAccount",value:function(r){var n=this;r&&(this.pre_switch_account_listener=r,this.preSwitchAccountDisposer=(0,e.when)((function(){return n.root_store.client.pre_switch_broadcast}),(function(){try{var e=n.pre_switch_account_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Pre-switch account listeners are required to return a promise.");e.then((function(){n.root_store.client.setPreSwitchAccount(!1),n.onPreSwitchAccount(n.pre_switch_account_listener)}))}catch(e){(0,t.isProduction)()||console.error(e)}})))}},{key:"onLogout",value:function(r){var n=this;this.logoutDisposer=(0,e.when)((function(){return n.root_store.client.has_logged_out}),Y(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=n.logout_listener())||!r.then||"function"!=typeof r.then){e.next=6;break}r.then((function(){n.root_store.client.setLogout(!1),n.onLogout(n.logout_listener)})),e.next=7;break;case 6:throw new Error("Logout listeners are required to return a promise.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,t.isProduction)()||console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),this.logout_listener=r}},{key:"onClientInit",value:function(r){var n=this;this.clientInitDisposer=(0,e.when)((function(){return n.root_store.client.initialized_broadcast}),Y(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=n.client_init_listener())||!r.then||"function"!=typeof r.then){e.next=6;break}r.then((function(){n.root_store.client.setInitialized(!1),n.onClientInit(n.client_init_listener)})),e.next=7;break;case 6:throw new Error("Client init listeners are required to return a promise.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,t.isProduction)()||console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),this.client_init_listener=r}},{key:"onNetworkStatusChange",value:function(r){var n=this;this.networkStatusChangeDisposer=(0,e.reaction)((function(){return n.root_store.common.is_network_online}),(function(e){try{n.network_status_change_listener(e)}catch(e){(0,t.isProduction)()||console.error(e)}})),this.network_status_change_listener=r}},{key:"onThemeChange",value:function(r){var n=this;this.themeChangeDisposer=(0,e.reaction)((function(){return n.root_store.ui.is_dark_mode_on}),(function(e){try{n.theme_change_listener(e)}catch(e){(0,t.isProduction)()||console.error(e)}})),this.theme_change_listener=r}},{key:"onRealAccountSignupEnd",value:function(r){var n=this;this.realAccountSignupEndedDisposer=(0,e.when)((function(){return n.root_store.ui.has_real_account_signup_ended}),(function(){try{var e=n.real_account_signup_ended_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Real account signup listeners are required to return a promise.");e.then((function(){n.root_store.ui.setRealAccountSignupEnd(!1),n.onRealAccountSignupEnd(n.real_account_signup_ended_listener)}))}catch(e){(0,t.isProduction)()||console.error(e)}})),this.real_account_signup_ended_listener=r}},{key:"disposePreSwitchAccount",value:function(){"function"==typeof this.preSwitchAccountDisposer&&this.preSwitchAccountDisposer(),this.pre_switch_account_listener=null}},{key:"disposeSwitchAccount",value:function(){"function"==typeof this.switchAccountDisposer&&this.switchAccountDisposer(),this.switch_account_listener=null}},{key:"disposeLogout",value:function(){"function"==typeof this.logoutDisposer&&this.logoutDisposer(),this.logout_listener=null}},{key:"disposeClientInit",value:function(){"function"==typeof this.clientInitDisposer&&this.clientInitDisposer(),this.client_init_listener=null}},{key:"disposeNetworkStatusChange",value:function(){"function"==typeof this.networkStatusChangeDisposer&&this.networkStatusChangeDisposer(),this.network_status_change_listener=null}},{key:"disposeThemeChange",value:function(){"function"==typeof this.themeChangeDisposer&&this.themeChangeDisposer(),this.theme_change_listener=null}},{key:"disposeRealAccountSignupEnd",value:function(){"function"==typeof this.realAccountSignupEndedDisposer&&this.realAccountSignupEndedDisposer(),this.real_account_signup_ended_listener=null}},{key:"onUnmount",value:function(){this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout(),this.disposeClientInit(),this.disposeNetworkStatusChange(),this.disposeThemeChange(),this.disposeRealAccountSignupEnd()}},{key:"assertHasValidCache",value:function(e){if(this.root_store.client.loginid!==e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(e){return e()})),this.partial_fetch_time=!1}}}]),r}();function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function oe(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function ie(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){oe(i,n,o,s,a,"next",e)}function a(e){oe(i,n,o,s,a,"throw",e)}s(void 0)}))}}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ae(e,t){return ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ae(e,t)}function ce(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ue(e)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}re.STORAGES=Object.freeze({LOCAL_STORAGE:Symbol("LOCAL_STORAGE"),SESSION_STORAGE:Symbol("SESSION_STORAGE")});var he=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(h,r);var n,o,i,s,l=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=le(e);if(t){var o=le(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ce(this,r)}}(h);function h(t){var r,n=t.root_store,o=t.WS;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(r=l.call(this,{root_store:n})).is_loading=!1,r.is_p2p_visible=!1,r.p2p_notification_count=0,r.cashier_route_tab_index=0,r.is_deposit=!1,r.should_show_all_available_currencies=!1,r.is_cashier_default=!0,r.deposit_target="",r.should_set_currency_modal_title_change=!1,r.p2p_advertiser_error=void 0,r.has_set_currency=!1,r.should_percentage_reset=!1,r.percentage=0,r.show_p2p_in_cashier_default=!1,r.onRemount=function(){},r.active_container=u.containers.deposit,r.is_populating_values=!1,(0,e.makeObservable)(ue(r),{is_loading:e.observable,is_p2p_visible:e.observable,p2p_notification_count:e.observable,cashier_route_tab_index:e.observable,is_deposit:e.observable,should_show_all_available_currencies:e.observable,is_cashier_default:e.observable,deposit_target:e.observable,should_set_currency_modal_title_change:e.observable,p2p_advertiser_error:e.observable,has_set_currency:e.observable,should_percentage_reset:e.observable,percentage:e.observable,show_p2p_in_cashier_default:e.observable,onRemount:e.observable,setOnRemount:e.action.bound,is_crypto:e.computed,is_p2p_enabled:e.computed,showP2pInCashierDefault:e.action.bound,attachCashierToMenu:e.action.bound,replaceCashierMenuOnclick:e.action.bound,setHasSetCurrency:e.action.bound,changeSetCurrencyModalTitle:e.action.bound,onMountCashierDefault:e.action.bound,calculatePercentage:e.action.bound,percentageSelectorSelectionStatus:e.action.bound,setIsDeposit:e.action.bound,setShouldShowAllAvailableCurrencies:e.action.bound,setIsCashierDefault:e.action.bound,setDepositTarget:e.action.bound,continueRoute:e.action.bound,setAccountSwitchListener:e.action.bound,init:e.action.bound,getAdvertizerError:e.action.bound,setP2pAdvertiserError:e.action.bound,checkP2pStatus:e.action.bound,onMountCommon:e.action.bound,setCashierTabIndex:e.action.bound,setNotificationCount:e.action.bound,setIsP2pVisible:e.action.bound,is_cashier_locked:e.computed,is_system_maintenance:e.computed,setLoading:e.action.bound,setActiveTab:e.action.bound}),r.WS=o,r.root_store=n,(0,e.when)((function(){return r.root_store.client.is_logged_in}),(function(){r.setHasSetCurrency(),r.attachCashierToMenu()})),r.has_set_currency||r.changeSetCurrencyModalTitle(),(0,e.reaction)((function(){return[r.root_store.client.switched,r.root_store.client.is_logged_in,r.root_store.client.currency]}),(function(){r.init()})),r}return function(e,t,r){t&&se(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(h,[{key:"setOnRemount",value:function(e){this.onRemount=e}},{key:"is_crypto",get:function(){var e=this.root_store.client.currency;return!!e&&(0,t.isCryptocurrency)(e)}},{key:"is_p2p_enabled",get:function(){return this.is_p2p_visible&&!this.root_store.client.is_eu}},{key:"showP2pInCashierDefault",value:function(){var e=this.root_store.client,r=e.account_list,n=e.is_virtual,o="RestrictedCountry"===this.p2p_advertiser_error,i=r.some((function(e){return"USD"===e.title})),s=r.some((function(e){return!(0,t.isCryptocurrency)(e.title)&&"Real"!==e.title}));this.show_p2p_in_cashier_default=!(o||n||s&&!i)}},{key:"attachCashierToMenu",value:function(){var e=this.root_store,r=e.menu,n=e.ui;this.has_set_currency||this.setHasSetCurrency(),r.attach({id:"dt_cashier_tab",icon:a().createElement(B,{p2p_notification_count:this.p2p_notification_count}),text:function(){return(0,c.localize)("Cashier")},link_to:this.has_set_currency&&t.routes.cashier,onClick:!this.has_set_currency&&n.toggleSetCurrencyModal,login_only:!0})}},{key:"replaceCashierMenuOnclick",value:function(){var e=this.root_store,r=e.menu,n=e.ui;this.setHasSetCurrency(),r.update({id:"dt_cashier_tab",icon:a().createElement(B,{p2p_notification_count:this.p2p_notification_count}),text:function(){return(0,c.localize)("Cashier")},link_to:this.has_set_currency&&t.routes.cashier,onClick:!this.has_set_currency&&n.toggleSetCurrencyModal,login_only:!0},1)}},{key:"setHasSetCurrency",value:function(){var e=this.root_store.client,t=e.account_list,r=e.has_active_real_account;this.has_set_currency=t.filter((function(e){return!e.is_virtual})).some((function(e){return"Real"!==e.title}))||!r}},{key:"changeSetCurrencyModalTitle",value:function(){this.should_set_currency_modal_title_change=!0}},{key:"onMountCashierDefault",value:(s=ie(regeneratorRuntime.mark((function e(){var t,r,n,o,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.root_store.modules.cashier,o=n.account_prompt_dialog,i=n.payment_agent,this.has_set_currency||this.setHasSetCurrency(),this.setIsCashierDefault(!0),o.resetIsConfirmed(),this.setLoading(!0),null!==(t=i.all_payment_agent_list)&&void 0!==t&&null!==(r=t.paymentagent_list)&&void 0!==r&&r.list){e.next=10;break}return e.next=8,i.getAllPaymentAgentList();case 8:s=e.sent,i.setAllPaymentAgentList(s);case 10:this.setLoading(!1);case 11:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"calculatePercentage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root_store.modules.cashier.crypto_fiat_converter.converter_from_amount,t=this.root_store,r=t.client,n=t.modules,o=n.cashier.account_transfer;this.active_container===o.container?this.percentage=+(e/+o.selected_from.balance*100).toFixed(0):this.percentage=+(e/+r.balance*100).toFixed(0),isFinite(this.percentage)||(this.percentage=0)}},{key:"percentageSelectorSelectionStatus",value:function(e){this.should_percentage_reset=e,e&&(this.percentage=0)}},{key:"setIsDeposit",value:function(e){this.is_deposit=e}},{key:"setShouldShowAllAvailableCurrencies",value:function(e){this.should_show_all_available_currencies=e}},{key:"setIsCashierDefault",value:function(e){this.is_cashier_default=e}},{key:"setDepositTarget",value:function(e){this.deposit_target=e}},{key:"continueRoute",value:function(){this.root_store.common.routeTo(this.deposit_target)}},{key:"setAccountSwitchListener",value:function(){this.disposeSwitchAccount(),this.onSwitchAccount(this.accountSwitcherListener)}},{key:"init",value:(i=ie(regeneratorRuntime.mark((function e(){var t,r,n,o,i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.root_store.modules.cashier){e.next=13;break}return t=this.root_store,r=t.client,n=r.is_logged_in,o=r.switched,i=t.modules,s=i.cashier,a=s.account_prompt_dialog,c=s.withdraw,e.next=5,this.WS.wait("get_settings");case 5:if(!n){e.next=13;break}return e.next=8,this.getAdvertizerError();case 8:if(a.resetLastLocation(),o){e.next=13;break}return this.checkP2pStatus(),e.next=13,c.check10kLimit();case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getAdvertizerError",value:(o=ie(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.authorized.p2pAdvertiserInfo();case 2:r=e.sent,this.setP2pAdvertiserError((0,t.getPropertyValue)(r,["error","code"]));case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setP2pAdvertiserError",value:function(e){this.p2p_advertiser_error=e}},{key:"checkP2pStatus",value:function(){var e=this.p2p_advertiser_error,t="RestrictedCountry"===e||"RestrictedCurrency"===e;this.setIsP2pVisible(!(t||this.root_store.client.is_virtual))}},{key:"onMountCommon",value:(n=ie(regeneratorRuntime.mark((function e(r){var n,o,i,s,a,c,u,l,h,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.root_store,o=n.client,i=n.common,s=n.modules,a=s.cashier,c=a.account_transfer,u=a.onramp,l=a.payment_agent,h=a.payment_agent_transfer,d=a.transaction_history,!o.is_logged_in){e.next=12;break}if(!this.is_populating_values){e.next=5;break}return e.abrupt("return");case 5:this.is_populating_values=!0,r&&this.setOnRemount(this.onMountCommon),l.setPaymentAgentList().then(l.filterPaymentAgentList),h.is_payment_agent||h.checkIsPaymentAgent(),c.accounts_list.length||c.sortAccountsTransfer(),!u.is_onramp_tab_visible&&window.location.pathname.endsWith(t.routes.cashier_onramp)&&i.routeTo(t.routes.cashier_deposit),!d.is_crypto_transactions_visible&&window.location.pathname.endsWith(t.routes.cashier_crypto_transactions)&&(i.routeTo(t.routes.cashier_deposit),d.setIsCryptoTransactionsVisible(!0),d.onMount());case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setCashierTabIndex",value:function(e){this.cashier_route_tab_index=e}},{key:"setNotificationCount",value:function(e){this.p2p_notification_count=e}},{key:"setIsP2pVisible",value:function(e){var r;this.is_p2p_visible=e,!e&&window.location.pathname.endsWith(t.routes.cashier_p2p)&&this.root_store.common.routeTo(null!==(r=this.root_store.modules.cashier.account_prompt_dialog.last_location)&&void 0!==r?r:t.routes.cashier_deposit)}},{key:"is_cashier_locked",get:function(){var e=this.root_store.client.account_status;return!(null==e||!e.status)&&e.status.some((function(e){return"cashier_locked"===e}))}},{key:"is_system_maintenance",get:function(){var e=this.root_store.client.account_status;return!(null==e||!e.cashier_validation)&&e.cashier_validation.some((function(e){return"system_maintenance"===e}))}},{key:"setLoading",value:function(e){this.is_loading=e}},{key:"setActiveTab",value:function(e){this.active_container=e}},{key:"accountSwitcherListener",value:function(){var e=this.root_store.modules.cashier,t=e.iframe,r=e.payment_agent;return e.withdraw.verification.clearVerification(),r.verification.clearVerification(),t.clearIframe(),this.payment_agent=r,this.is_populating_values=!1,this.onRemount(),Promise.resolve()}}]),h}(re);function de(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _e=function(){function t(r){var n=r.WS,o=r.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.iframe_height=0,this.iframe_url="",this.is_session_timeout=!0,this.onIframeLoaded="",this.timeout_session="",(0,e.makeObservable)(this,{iframe_height:e.observable,iframe_url:e.observable,is_session_timeout:e.observable,timeout_session:e.observable,setSessionTimeout:e.action.bound,checkIframeLoaded:e.action.bound,clearTimeoutCashierUrl:e.action.bound,setTimeoutCashierUrl:e.action.bound,setIframeUrl:e.action.bound,setContainerHeight:e.action.bound,clearIframe:e.action.bound}),this.root_store=o,this.WS=n}var r,n;return function(e,t,r){t&&fe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"setSessionTimeout",value:function(e){this.is_session_timeout=e,e&&this.removeOnIframeLoaded()}},{key:"checkIframeLoaded",value:(r=regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.root_store,r=t.modules,n=t.ui,this.removeOnIframeLoaded(),this.onIframeLoaded=function(e){/cashier|doughflow/.test(e.origin)&&(r.cashier.general_store.setLoading(!1),n.is_mobile?this.setContainerHeight(window.innerHeight-100):this.setContainerHeight(window.innerHeight-190))}.bind(this),window.addEventListener("message",this.onIframeLoaded,!1);case 4:case"end":return e.stop()}}),e,this)})),n=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function s(e){de(i,n,o,s,a,"next",e)}function a(e){de(i,n,o,s,a,"throw",e)}s(void 0)}))},function(){return n.apply(this,arguments)})},{key:"removeOnIframeLoaded",value:function(){this.onIframeLoaded&&(window.removeEventListener("message",this.onIframeLoaded,!1),this.onIframeLoaded="")}},{key:"clearTimeoutCashierUrl",value:function(){this.timeout_session&&clearTimeout(this.timeout_session)}},{key:"setTimeoutCashierUrl",value:function(){var e=this;this.clearTimeoutCashierUrl(),this.timeout_session=setTimeout((function(){e.setSessionTimeout(!0)}),6e4)}},{key:"setIframeUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root_store.modules.cashier.general_store.active_container,r=this.root_store,n=r.client,o=r.ui;e?(this.iframe_url="".concat(e,"&theme=").concat(o.is_dark_mode_on?"dark":"light"),n.setVerificationCode("",u.map_action[t])):this.iframe_url=e}},{key:"setContainerHeight",value:function(e){this.iframe_height=e}},{key:"clearIframe",value:function(){this.setContainerHeight(0),this.setIframeUrl(""),this.clearTimeoutCashierUrl(),this.setSessionTimeout(!0)}}]),t}();const pe=function(e){return{icon:{dark:"IcCashierBanxaDark",light:"IcCashierBanxaLight"},name:"Banxa",getDescription:function(){return(0,c.localize)("A fast and secure fiat-to-crypto payment service. Deposit cryptocurrencies from anywhere in the world using your credit/debit cards and bank transfers.")},getAllowedResidencies:function(){return["*"]},getPaymentIcons:function(){return[{dark:"IcCashierVisaDark",light:"IcCashierVisaLight"},{dark:"IcCashierMastercardDark",light:"IcCashierMastercardLight"},{dark:"IcCashierBpayDark",light:"IcCashierBpayLight"},{dark:"IcCashierSepaDark",light:"IcCashierSepaLight"},{dark:"IcCashierBlueshyftDark",light:"IcCashierBlueshyftLight"},{dark:"IcCashierFlexepinDark",light:"IcCashierFlexepinLight"},{dark:"IcCashierPayIdDark",light:"IcCashierPayIdLight"},{dark:"IcCashierPoliDark",light:"IcCashierPoliLight"},{dark:"IcCashierApplePay",light:"IcCashierApplePay"},{dark:"IcCashierInteracEtransfer",light:"IcCashierInteracEtransfer"},{dark:"IcCashierIdeal",light:"IcCashierIdeal"},{dark:"IcCashierPostBillPayDark",light:"IcCashierPostBillPayLight"},{dark:"IcCashierSofort",light:"IcCashierSofort"}]},getScriptDependencies:function(){return[]},getDefaultFromCurrency:function(){return""},getFromCurrencies:function(){return["*"]},getToCurrencies:function(){return["*"]},getWidgetHtml:function(){return new Promise((function(t,r){e.WS.serviceToken({service_token:1,service:"banxa",referrer:window.location.href}).then((function(e){if(e.error)r(e.error.message);else{var n=e.service_token.banxa.url;n&&window.open(n),t()}}))}))},onMountWidgetContainer:function(){},should_show_deposit_address:!1}},me=function(e){return{icon:{dark:"IcCashierChangellyDark",light:"IcCashierChangellyLight"},name:"Changelly",getDescription:function(){return(0,c.localize)("Your simple access to crypto. Fast and secure way to exchange and purchase cryptocurrencies. 24/7 live chat support.")},getAllowedResidencies:function(){return["*"]},getPaymentIcons:function(){return[{dark:"IcCashierVisaDark",light:"IcCashierVisaLight"},{dark:"IcCashierMastercardDark",light:"IcCashierMastercardLight"}]},getScriptDependencies:function(){return[]},getDefaultFromCurrency:function(){return"usd"},getFromCurrencies:function(){return["usd","eur","gbp"]},getToCurrencies:function(){return["bch","btc","etc","eth","ltc","ust"]},getWidgetHtml:function(){var t=this;return new Promise((function(r){var n=new URL("https://widget.changelly.com/?v=3&theme=default");n.searchParams.append("fromDefault",t.getDefaultFromCurrency());var o=e.root_store.client.currency.toLowerCase();if(t.getToCurrencies().includes(o)){var i="ust"===o?"usdt":o;n.searchParams.append("to",i),n.searchParams.append("toDefault",i)}n.searchParams.append("amount",1),n.searchParams.append("merchant_id","iiq3jdt2p44yrfbx"),window.open(n),r()}))},onMountWidgetContainer:function(){},should_show_deposit_address:!0}},ve=function(e){return{icon:{dark:"IcCashierXanpoolDark",light:"IcCashierXanpoolLight"},name:"XanPool",getDescription:function(){return(0,c.localize)("Buy cryptocurrencies in an instant. Enjoy easy, quick, and secure exchanges using your local payment methods.")},getAllowedResidencies:function(){return["*"]},getPaymentIcons:function(){return[{dark:"IcCashierFpsDark",light:"IcCashierFpsLight"},{dark:"IcCashierAliPayDark",light:"IcCashierAliPayLight"},{dark:"IcCashierGoPayDark",light:"IcCashierGoPayLight"},{dark:"IcCashierMandiriPay",light:"IcCashierMandiriPay"},{dark:"IcCashierInstaPayLight",light:"IcCashierInstaPayDark"},{dark:"IcCashierCebuanaLhuillierDark",light:"IcCashierCebuanaLhuillierLight"},{dark:"IcCashierPayNowDark",light:"IcCashierPayNowLight"},{dark:"IcCashierUpiDark",light:"IcCashierUpiLight"},{dark:"IcCashierPromptPayDark",light:"IcCashierPromptPayLight"},{dark:"IcCashierViettlePay",light:"IcCashierViettlePay"}]},getScriptDependencies:function(){return[]},getToCurrencies:function(){return["btc","eth","ust","zil","nem"]},getWidgetHtml:function(){return new Promise((function(t){var r=e.root_store.client.currency,n="https://checkout.xanpool.com/";n+="?apiKey=db4ec638dff9a68abda1ef6b7638c220",n+="&redirectUrl=".concat(window.location.href),n+="&wallet=".concat(e.deposit_address),n+="&cryptoCurrency=".concat("UST"===r?"USDT":r),n+="&transactionType=buy",window.open(n),t()}))},onMountWidgetContainer:function(){},should_show_deposit_address:!1}};function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function be(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function ge(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){be(i,n,o,s,a,"next",e)}function a(e){be(i,n,o,s,a,"throw",e)}s(void 0)}))}}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ke(e,t)}function Ce(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Se(e)}function Se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Te(e)}var Ae=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(o,r);var n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Te(e);if(t){var o=Te(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ce(this,r)}}(o);function o(t){var r,i=t.WS,s=t.root_store;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=n.call(this,{root_store:s})).api_error=null,r.deposit_address=null,r.is_deposit_address_loading=!0,r.is_deposit_address_popover_open=!1,r.is_onramp_modal_open=!1,r.is_requesting_widget_html=!1,r.onramp_providers=[],r.selected_provider=null,r.should_show_widget=!1,r.widget_error=null,r.widget_html=null,r.deposit_address_ref=null,(0,e.makeObservable)(Se(r),{api_error:e.observable,deposit_address:e.observable,is_deposit_address_loading:e.observable,is_deposit_address_popover_open:e.observable,is_onramp_modal_open:e.observable,is_requesting_widget_html:e.observable,onramp_providers:e.observable.shallow,selected_provider:e.observable.ref,should_show_widget:e.observable,widget_error:e.observable,widget_html:e.observable,is_onramp_tab_visible:e.computed,filtered_onramp_providers:e.computed,onramp_popup_modal_title:e.computed,should_show_dialog:e.computed,onMountOnramp:e.action.bound,onUnmountOnramp:e.action.bound,onClickCopyDepositAddress:e.action.bound,onClickDisclaimerContinue:e.action.bound,onClickGoToDepositPage:e.action.bound,pollApiForDepositAddress:e.action.bound,resetPopup:e.action.bound,setApiError:e.action.bound,setCopyIconRef:e.action.bound,setDepositAddress:e.action.bound,setDepositAddressRef:e.action.bound,setIsDepositAddressLoading:e.action.bound,setIsDepositAddressPopoverOpen:e.action.bound,setIsOnRampModalOpen:e.action.bound,setIsRequestingWidgetHtml:e.action.bound,setSelectedProvider:e.action.bound,setShouldShowWidget:e.action.bound,setOnrampProviders:e.action.bound,setWidgetError:e.action.bound,setWidgetHtml:e.action.bound}),r.WS=i,r.onClientInit(ge(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.setOnrampProviders([me(Se(r)),ve(Se(r)),pe(Se(r))]);case 1:case"end":return e.stop()}}),e)})))),r}return function(e,t,r){t&&we(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(o,[{key:"is_onramp_tab_visible",get:function(){var e=this.root_store.client;return!1===e.is_virtual&&(0,t.isCryptocurrency)(e.currency)&&this.filtered_onramp_providers.length>0}},{key:"filtered_onramp_providers",get:function(){var e=this.root_store.client;return this.onramp_providers.filter((function(t){var r=t.getToCurrencies();return r.includes("*")||r.includes(e.currency.toLowerCase())})).filter((function(t){var r=t.getAllowedResidencies();return r.includes("*")||r.includes(e.residence)}))}},{key:"onramp_popup_modal_title",get:function(){return this.should_show_widget?(0,c.localize)("Payment channel"):this.selected_provider?this.should_show_dialog?(0,c.localize)("Our server cannot retrieve an address."):" ":void 0}},{key:"should_show_dialog",get:function(){return this.api_error}},{key:"onMountOnramp",value:function(){var r=this;this.disposeThirdPartyJsReaction=(0,e.reaction)((function(){return r.selected_provider}),function(){var e=ge(regeneratorRuntime.mark((function e(n){var o,i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(0!==(o=n.getScriptDependencies()).length){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,h.e("loadjs").then(h.t.bind(h,"../../../node_modules/loadjs/dist/loadjs.umd.js",23));case 7:i=e.sent,s=i.default,a="".concat((0,t.getKebabCase)(n.name),"-onramp"),s.isDefined(a)||s(o,a,{error:function(){console.warn("Dependencies for onramp provider ".concat(n.name," could not be loaded.")),r.setSelectedProvider(null)}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.disposeGetWidgetHtmlReaction=(0,e.reaction)((function(){return r.should_show_widget}),(function(e){if(e){if(r.is_requesting_widget_html)return;r.setIsRequestingWidgetHtml(!0),r.selected_provider.getWidgetHtml().then((function(e){e?r.setWidgetHtml(e):r.setShouldShowWidget(!1)})).catch((function(e){r.setWidgetError(e)})).finally((function(){return r.setIsRequestingWidgetHtml(!1)}))}}))}},{key:"onUnmountOnramp",value:function(){"function"==typeof this.disposeThirdPartyJsReaction&&this.disposeThirdPartyJsReaction(),"function"==typeof this.disposeGetWidgetHtmlReaction&&this.disposeGetWidgetHtmlReaction()}},{key:"onClickCopyDepositAddress",value:function(){var e=this,t=document.createRange();t.selectNodeContents(this.deposit_address_ref);var r=window.getSelection();r.removeAllRanges(),r.addRange(t),navigator.clipboard.writeText(this.deposit_address).then((function(){e.setIsDepositAddressPopoverOpen(!0),setTimeout((function(){return e.setIsDepositAddressPopoverOpen(!1)}),500)}))}},{key:"onClickDisclaimerContinue",value:function(){this.setShouldShowWidget(!0)}},{key:"onClickGoToDepositPage",value:function(){this.pollApiForDepositAddress(!1),window.open((0,t.websiteUrl)()+t.routes.cashier_deposit.substring(1))}},{key:"pollApiForDepositAddress",value:function(e){var t=this;this.setIsDepositAddressLoading(!0),this.setApiError(null);var r=setInterval((function(){return n}),3e3),n=function(){t.WS.authorized.cashier("deposit",{provider:"crypto",type:"api"}).then((function(n){var o=!1;if(n.error)t.setApiError(n.error),o=!0;else{var i=n.cashier.deposit.address;(i||e)&&(t.setDepositAddress(i),o=!0)}o&&(clearInterval(r),t.setIsDepositAddressLoading(!1))}))};n(),setTimeout((function(){clearInterval(r),t.setIsDepositAddressLoading(!1)}),3e4)}},{key:"resetPopup",value:function(){this.setApiError(null),this.setDepositAddress(null),this.setDepositAddressRef(null),this.setIsDepositAddressLoading(!0),this.setSelectedProvider(null),this.setShouldShowWidget(!1),this.setWidgetError(null),this.setWidgetHtml(null)}},{key:"setApiError",value:function(e){this.api_error=e}},{key:"setCopyIconRef",value:function(e){this.copy_icon_ref=e}},{key:"setDepositAddress",value:function(e){this.deposit_address=e}},{key:"setDepositAddressRef",value:function(e){this.deposit_address_ref=e}},{key:"setIsDepositAddressLoading",value:function(e){this.is_deposit_address_loading=e}},{key:"setIsDepositAddressPopoverOpen",value:function(e){this.is_deposit_address_popover_open=e}},{key:"setIsOnRampModalOpen",value:function(e){this.is_onramp_modal_open=e}},{key:"setIsRequestingWidgetHtml",value:function(e){this.is_requesting_widget_html=e}},{key:"setSelectedProvider",value:function(e){e?(this.selected_provider=e,this.setIsOnRampModalOpen(!0),this.pollApiForDepositAddress(!0)):(this.setIsOnRampModalOpen(!1),this.selected_provider=null)}},{key:"setShouldShowWidget",value:function(e){this.should_show_widget=e}},{key:"setOnrampProviders",value:function(e){this.onramp_providers=e.slice()}},{key:"setWidgetError",value:function(e){this.widget_error=e}},{key:"setWidgetHtml",value:function(e){this.widget_html=e}}]),o}(re);function Pe(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ie=function(){function t(r){var n=r.WS,o=r.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.is_button_clicked=!1,this.timeout_button="",this.error=new p,this.is_email_sent=!1,this.is_resend_clicked=!1,this.resend_timeout=60,(0,e.makeObservable)(this,{is_button_clicked:e.observable,timeout_button:e.observable,error:e.observable,is_email_sent:e.observable,is_resend_clicked:e.observable,resend_timeout:e.observable,setIsButtonClicked:e.action.bound,setTimeoutButton:e.action.bound,setIsEmailSent:e.action.bound,setIsResendClicked:e.action.bound,setResendTimeout:e.action.bound,setTimeoutVerification:e.action.bound,sendVerificationEmail:e.action.bound,resendVerificationEmail:e.action.bound}),this.root_store=o,this.WS=n}var r,n;return function(e,t,r){t&&xe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"setIsButtonClicked",value:function(e){this.is_button_clicked=e}},{key:"setTimeoutButton",value:function(e){this.timeout_button=e}},{key:"setIsEmailSent",value:function(e){this.is_email_sent=e}},{key:"setIsResendClicked",value:function(e){this.is_resend_clicked=e}},{key:"setResendTimeout",value:function(e){this.resend_timeout=e}},{key:"clearTimeoutVerification",value:function(){this.timeout_button&&clearTimeout(this.timeout_button)}},{key:"setTimeoutVerification",value:function(){var e=this;this.clearTimeoutVerification(),this.setTimeoutButton(setTimeout((function(){e.clearVerification()}),36e5))}},{key:"sendVerificationEmail",value:(r=regeneratorRuntime.mark((function e(){var t,r,n,o,i,s,a,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.root_store,r=t.client,n=t.modules,o=n.cashier.payment_agent.resetPaymentAgent,i=n.cashier.general_store.active_container,s=u.map_action[i],!this.is_button_clicked&&r.email){e.next=6;break}return e.abrupt("return");case 6:return this.error.setErrorMessage(""),this.setIsButtonClicked(!0),a="payment_agent_withdraw"===s?"paymentagent_withdraw":"payment_withdraw",e.next=11,this.WS.verifyEmail(r.email,a);case 11:if(!(c=e.sent).error){e.next=20;break}if(!["PaymentAgentJustification","PaymentAgentWithdrawSameMethod","PaymentAgentUseOtherMethod"].includes(c.error.code)){e.next=16;break}return this.error.setErrorMessage(c.error,null,null),e.abrupt("return");case 16:this.clearVerification(),"PaymentAgentWithdrawError"===c.error.code?this.error.setErrorMessage(c.error,o,null):this.error.setErrorMessage(c.error,(function(){l.error.setErrorMessage("",null,null)}),null),e.next=22;break;case 20:this.setIsEmailSent(!0),this.setTimeoutVerification();case 22:case"end":return e.stop()}}),e,this)})),n=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function s(e){Pe(i,n,o,s,a,"next",e)}function a(e){Pe(i,n,o,s,a,"throw",e)}s(void 0)}))},function(){return n.apply(this,arguments)})},{key:"resendVerificationEmail",value:function(){this.resend_timeout<60||(this.setIsButtonClicked(!1),this.setCountDownResendVerification(),this.sendVerificationEmail())}},{key:"setCountDownResendVerification",value:function(){var e=this;this.setResendTimeout(this.resend_timeout-1);var t=setInterval((function(){1===e.resend_timeout?(e.setResendTimeout(60),clearInterval(t)):e.setResendTimeout(e.resend_timeout-1)}),1e3)}},{key:"clearVerification",value:function(){var e=this.root_store,t=e.client,r=e.modules.cashier.general_store.active_container,n=u.map_action[r];this.clearTimeoutVerification(),this.setIsButtonClicked(!1),this.setIsEmailSent(!1),this.setIsResendClicked(!1),this.setResendTimeout(60),this.error.setErrorMessage("",null,null),t.setVerificationCode("",n)}}]),t}();function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){Ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function Me(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){De(i,n,o,s,a,"next",e)}function a(e){De(i,n,o,s,a,"throw",e)}s(void 0)}))}}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var We=function(){function r(t){var n=this,o=t.WS,i=t.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.list=[],this.agents=[],this.container=u.containers.payment_agent,this.error=new p,this.filtered_list=[],this.is_name_selected=!0,this.is_withdraw=!1,this.is_try_withdraw_successful=!1,this.is_withdraw_successful=!1,this.confirm={},this.receipt={},this.selected_bank=0,this.supported_banks=[],this.verification=new Ie({root_store:this.root_store,WS:this.WS}),this.active_tab_index=0,this.all_payment_agent_list=[],this.resetPaymentAgent=function(){n.error.setErrorMessage(""),n.setIsWithdraw(!1),n.verification.clearVerification(),n.setActiveTabIndex(0)},(0,e.makeObservable)(this,{list:e.observable,agents:e.observable,container:e.observable,error:e.observable,filtered_list:e.observable,is_name_selected:e.observable,is_withdraw:e.observable,is_try_withdraw_successful:e.observable,is_withdraw_successful:e.observable,confirm:e.observable,receipt:e.observable,selected_bank:e.observable,supported_banks:e.observable,verification:e.observable,active_tab_index:e.observable,all_payment_agent_list:e.observable,setActiveTabIndex:e.action.bound,setActiveTab:e.action.bound,is_payment_agent_visible:e.computed,getPaymentAgentList:e.action.bound,getPaymentAgentDetails:e.action.bound,addSupportedBank:e.action.bound,clearSuppertedBanks:e.action.bound,sortSupportedBanks:e.action.bound,setList:e.action.bound,clearList:e.action.bound,setPaymentAgentList:e.action.bound,filterPaymentAgentList:e.action.bound,onChangePaymentMethod:e.action.bound,setIsWithdraw:e.action.bound,setIsTryWithdrawSuccessful:e.action.bound,setIsWithdrawSuccessful:e.action.bound,setConfirmation:e.action.bound,setReceipt:e.action.bound,addPaymentAgent:e.action.bound,onMountPaymentAgentWithdraw:e.action.bound,requestTryPaymentAgentWithdraw:e.action.bound,resetPaymentAgent:e.action.bound,onMountPaymentAgentList:e.action.bound,setAllPaymentAgentList:e.action.bound,is_payment_agent_visible_in_onboarding:e.computed,requestPaymentAgentWithdraw:e.action.bound}),this.root_store=i,this.WS=o}var n,o,i,s,a,c,l,h;return function(e,t,r){t&&Le(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"setActiveTabIndex",value:function(e){this.active_tab_index=e}},{key:"setActiveTab",value:function(e){this.setActiveTabIndex(e),1===e&&this.verification.sendVerificationEmail()}},{key:"is_payment_agent_visible",get:function(){return!(!this.filtered_list.length&&!this.agents.length)}},{key:"getPaymentAgentList",value:(h=Me(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.wait("get_settings");case 2:return t=this.root_store.client,r=t.residence,n=t.currency,e.abrupt("return",this.WS.authorized.paymentAgentList(r,n));case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"getPaymentAgentDetails",value:(l=Me(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.authorized.paymentAgentDetails();case 2:return t=e.sent,r=t.paymentagent_details,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"addSupportedBank",value:function(e){this.supported_banks.find((function(t){return t.value===e.toLowerCase()}))||this.supported_banks.push({text:e,value:e.toLowerCase()})}},{key:"clearSuppertedBanks",value:function(){this.supported_banks=[]}},{key:"sortSupportedBanks",value:function(){this.supported_banks.replace(this.supported_banks.slice().sort((function(e,t){return e.value<t.value?-1:e.value>t.value?1:0})))}},{key:"setList",value:function(e){this.list.push(e)}},{key:"clearList",value:function(){this.list=[]}},{key:"setPaymentAgentList",value:(c=Me(regeneratorRuntime.mark((function e(t){var r,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,e.t0){e.next=5;break}return e.next=4,this.getPaymentAgentList();case 4:e.t0=e.sent;case 5:r=e.t0,this.clearList(),this.clearSuppertedBanks();try{null===(n=r.paymentagent_list)||void 0===n||n.list.forEach((function(e){o.setList({email:e.email,phones:(null==e?void 0:e.phone_numbers)||(null==e?void 0:e.telephone),name:e.name,supported_banks:(null==e?void 0:e.supported_payment_methods)||(null==e?void 0:e.supported_banks),urls:(null==e?void 0:e.urls)||(null==e?void 0:e.url)}),e.supported_banks&&(null!=e&&e.supported_payment_methods?e.supported_payment_methods.map((function(e){return e.payment_method})):e.supported_banks.split(",")).forEach((function(e){o.addSupportedBank(e)}))}))}catch(e){console.error(e)}this.sortSupportedBanks();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"filterPaymentAgentList",value:function(e){var r=this,n=this.root_store.common;e?(this.filtered_list=[],this.list.forEach((function(t){var n=null==t?void 0:t.supported_banks;n&&-1!==("string"==typeof n?n.toLowerCase().split(",").indexOf(e):n.map((function(e){return e.payment_method.toLowerCase()})).indexOf(e))&&r.filtered_list.push(t)}))):this.filtered_list=this.list,!this.is_payment_agent_visible&&window.location.pathname.endsWith(t.routes.cashier_pa)&&n.routeTo(t.routes.cashier_deposit)}},{key:"onChangePaymentMethod",value:function(e){var t=e.target,r="0"===t.value?parseInt(t.value):t.value;this.selected_bank=r,this.filterPaymentAgentList(r)}},{key:"setIsWithdraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.is_withdraw;this.is_withdraw=e}},{key:"setIsTryWithdrawSuccessful",value:function(e){this.error.setErrorMessage(""),this.is_try_withdraw_successful=e}},{key:"setIsWithdrawSuccessful",value:function(e){this.is_withdraw_successful=e}},{key:"setConfirmation",value:function(e){var t=e.amount,r=e.currency,n=e.loginid,o=e.payment_agent_name;this.confirm={amount:t,currency:r,loginid:n,payment_agent_name:o}}},{key:"setReceipt",value:function(e){var t=e.amount_transferred,r=e.payment_agent_email,n=e.payment_agent_id,o=e.payment_agent_name,i=e.payment_agent_phone,s=e.payment_agent_url;this.receipt={amount_transferred:t,payment_agent_email:r,payment_agent_id:n,payment_agent_name:o,payment_agent_phone:i,payment_agent_url:s}}},{key:"addPaymentAgent",value:function(e){this.agents.push({text:e.name,value:e.paymentagent_loginid,max_withdrawal:e.max_withdrawal,min_withdrawal:e.min_withdrawal,email:e.email,phone:e.telephone,url:e.url})}},{key:"onMountPaymentAgentWithdraw",value:(a=Me(regeneratorRuntime.mark((function e(){var r,n,o,i,s,a,c,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.root_store,n=r.common,o=r.modules,i=o.cashier.general_store,s=i.setLoading,a=i.onMountCommon,s(!0),this.onRemount=this.onMountPaymentAgentWithdraw,a(),this.setIsWithdraw(!0),this.setIsWithdrawSuccessful(!1),this.setReceipt({}),this.agents.length){e.next=14;break}return e.next=11,this.getPaymentAgentList();case 11:(c=e.sent).paymentagent_list.list.forEach((function(e){u.addPaymentAgent(e)})),!c.paymentagent_list.list.length&&window.location.pathname.endsWith(t.routes.cashier_pa)&&n.routeTo(t.routes.cashier_deposit);case 14:s(!1);case 15:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"requestTryPaymentAgentWithdraw",value:(s=Me(regeneratorRuntime.mark((function e(t){var r,n,o,i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.loginid,n=t.currency,o=t.amount,i=t.verification_code,this.error.setErrorMessage(""),e.next=4,this.WS.authorized.paymentAgentWithdraw({loginid:r,currency:n,amount:o,verification_code:i,dry_run:1});case 4:2==+(s=e.sent).paymentagent_withdraw?(a=this.agents.find((function(e){return e.value===r})),this.setConfirmation(Re({amount:o,currency:n,loginid:r},a&&{payment_agent_name:a.text})),this.setIsTryWithdrawSuccessful(!0)):this.error.setErrorMessage(s.error,this.resetPaymentAgent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onMountPaymentAgentList",value:(i=Me(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.modules.cashier.general_store,r=t.setLoading,n=t.onMountCommon,r(!0),this.onRemount=this.onMountPaymentAgentList,e.next=5,n();case 5:return e.next=7,this.getPaymentAgentList();case 7:r(!1);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getAllPaymentAgentList",value:(o=Me(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.wait("get_settings");case 2:return e.abrupt("return",this.WS.allPaymentAgentList(this.root_store.client.residence));case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setAllPaymentAgentList",value:function(e){this.all_payment_agent_list=e}},{key:"is_payment_agent_visible_in_onboarding",get:function(){var e,t,r;return!(null===(e=this.all_payment_agent_list)||void 0===e||null===(t=e.paymentagent_list)||void 0===t||null===(r=t.list)||void 0===r||!r.length)}},{key:"requestPaymentAgentWithdraw",value:(n=Me(regeneratorRuntime.mark((function e(r){var n,o,i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.loginid,o=r.currency,i=r.amount,s=r.verification_code,this.error.setErrorMessage(""),e.next=4,this.WS.authorized.paymentAgentWithdraw({loginid:n,currency:o,amount:i,verification_code:s});case 4:1==+(a=e.sent).paymentagent_withdraw?(c=this.agents.find((function(e){return e.value===n})),this.setReceipt(Re(Re({amount_transferred:(0,t.formatMoney)(o,i,!0)},c&&{payment_agent_email:c.email,payment_agent_id:c.value,payment_agent_name:c.text,payment_agent_phone:c.phone,payment_agent_url:c.url}),!c&&{payment_agent_id:n})),this.setIsWithdrawSuccessful(!0),this.setIsTryWithdrawSuccessful(!1),this.setConfirmation({})):this.error.setErrorMessage(a.error,this.resetPaymentAgent);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),r}();function je(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function Fe(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){je(i,n,o,s,a,"next",e)}function a(e){je(i,n,o,s,a,"throw",e)}s(void 0)}))}}function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Be=function(){function r(t){var n=this,o=t.WS,i=t.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.container=u.containers.payment_agent_transfer,this.error=new p,this.is_payment_agent=!1,this.is_try_transfer_successful=!1,this.is_transfer_successful=!1,this.confirm={},this.receipt={},this.transfer_limit={},this.requestTryPaymentAgentTransfer=function(){var e=Fe(regeneratorRuntime.mark((function e(t){var r,o,i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.amount,o=t.currency,i=t.description,s=t.transfer_to,n.error.setErrorMessage(""),e.next=4,n.WS.authorized.paymentAgentTransfer({amount:r,currency:o,description:i,transfer_to:s,dry_run:1});case 4:return 2==+(a=e.sent).paymentagent_transfer?(n.setConfirmationPaymentAgentTransfer({client_id:s,client_name:a.client_to_full_name,amount:r,description:i}),n.setIsTryTransferSuccessful(!0)):n.error.setErrorMessage(a.error,n.resetPaymentAgentTransfer),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.requestPaymentAgentTransfer=function(){var e=Fe(regeneratorRuntime.mark((function e(t){var r,o,i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.amount,o=t.currency,i=t.description,s=t.transfer_to,n.error.setErrorMessage(""),e.next=4,n.WS.authorized.paymentAgentTransfer({amount:r,currency:o,description:i,transfer_to:s});case 4:return 1==+(a=e.sent).paymentagent_transfer?(n.setReceiptPaymentAgentTransfer({amount_transferred:r,client_id:s,client_name:a.client_to_full_name}),n.setIsTransferSuccessful(!0),n.setIsTryTransferSuccessful(!1),n.setConfirmationPaymentAgentTransfer({})):n.error.setErrorMessage(a.error,n.resetPaymentAgentTransfer),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.resetPaymentAgentTransfer=function(){n.setIsTransferSuccessful(!1),n.error.setErrorMessage("")},(0,e.makeObservable)(this,{container:e.observable,error:e.observable,is_payment_agent:e.observable,is_try_transfer_successful:e.observable,is_transfer_successful:e.observable,confirm:e.observable,receipt:e.observable,transfer_limit:e.observable,is_payment_agent_transfer_visible:e.computed,setIsPaymentAgent:e.action.bound,setIsTryTransferSuccessful:e.action.bound,setIsTransferSuccessful:e.action.bound,setConfirmationPaymentAgentTransfer:e.action.bound,setReceiptPaymentAgentTransfer:e.action.bound,setMinMaxPaymentAgentTransfer:e.action.bound,onMountPaymentAgentTransfer:e.action.bound,requestTryPaymentAgentTransfer:e.action.bound,requestPaymentAgentTransfer:e.action.bound,resetPaymentAgentTransfer:e.action.bound}),this.root_store=i,this.WS=o}var n,o,i;return function(e,t,r){t&&Ve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"is_payment_agent_transfer_visible",get:function(){return this.is_payment_agent}},{key:"checkIsPaymentAgent",value:(i=Fe(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.authorized.storage.getSettings();case 2:r=e.sent.get_settings,this.setIsPaymentAgent(null!==(t=null==r?void 0:r.is_authenticated_payment_agent)&&void 0!==t&&t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setIsPaymentAgent",value:function(e){!e&&window.location.pathname.endsWith(t.routes.cashier_pa_transfer)&&this.root_store.common.routeTo(t.routes.cashier_deposit),this.is_payment_agent=!!e}},{key:"setIsTryTransferSuccessful",value:function(e){this.error.setErrorMessage(""),this.is_try_transfer_successful=e}},{key:"setIsTransferSuccessful",value:function(e){this.is_transfer_successful=e}},{key:"setConfirmationPaymentAgentTransfer",value:function(e){var t=e.amount,r=e.client_id,n=e.client_name,o=e.description;this.confirm={amount:t,client_id:r,client_name:n,description:o}}},{key:"setReceiptPaymentAgentTransfer",value:function(e){var t=e.amount_transferred,r=e.client_id,n=e.client_name;this.receipt={amount_transferred:t,client_id:r,client_name:n}}},{key:"getCurrentPaymentAgent",value:(o=Fe(regeneratorRuntime.mark((function e(t){var r,n,o,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.root_store,n=r.client,o=r.modules,i=t.paymentagent_list.list.find((function(e){return e.paymentagent_loginid===n.loginid})),e.t0=i,e.t0){e.next=7;break}return e.next=6,o.cashier.payment_agent.getPaymentAgentDetails();case 6:e.t0=e.sent;case 7:return s=e.t0,e.abrupt("return",null!=s?s:{});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"setMinMaxPaymentAgentTransfer",value:function(e){var t=e.min_withdrawal,r=e.max_withdrawal;this.transfer_limit={min:t,max:r}}},{key:"onMountPaymentAgentTransfer",value:(n=Fe(regeneratorRuntime.mark((function e(){var t,r,n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.root_store.modules.cashier,r=t.general_store,n=t.payment_agent,r.setLoading(!0),this.onRemount=this.onMountPaymentAgentTransfer,e.next=5,r.onMountCommon();case 5:if(this.transfer_limit.min_withdrawal){e.next=13;break}return e.next=8,n.getPaymentAgentList();case 8:return o=e.sent,e.next=11,this.getCurrentPaymentAgent(o);case 11:i=e.sent,this.setMinMaxPaymentAgentTransfer(i);case 13:r.setLoading(!1);case 14:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]),r}();function Ne(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function He(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){Ne(i,n,o,s,a,"next",e)}function a(e){Ne(i,n,o,s,a,"throw",e)}s(void 0)}))}}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qe=function(){function r(t){var n=t.WS,o=t.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.crypto_transactions=[],this.is_crypto_transactions_cancel_modal_visible=!1,this.is_crypto_transactions_status_modal_visible=!1,this.is_crypto_transactions_visible=!1,this.is_loading=!1,this.selected_crypto_transaction_id="",this.selected_crypto_status="",this.selected_crypto_status_description="",(0,e.makeObservable)(this,{crypto_transactions:e.observable,is_crypto_transactions_cancel_modal_visible:e.observable,is_crypto_transactions_status_modal_visible:e.observable,is_crypto_transactions_visible:e.observable,is_loading:e.observable,selected_crypto_transaction_id:e.observable,selected_crypto_status:e.observable,selected_crypto_status_description:e.observable,onMount:e.action.bound,unsubscribeCryptoTransactions:e.action.bound,getCryptoTransactions:e.action.bound,setCryptoTransactionsHistory:e.action.bound,updateCryptoTransactions:e.action.bound,sortCryptoTransactions:e.action.bound,cancelCryptoTransaction:e.action.bound,setSelectedCryptoTransactionId:e.action.bound,setIsCryptoTransactionsCancelModalVisible:e.action.bound,showCryptoTransactionsCancelModal:e.action.bound,hideCryptoTransactionsCancelModal:e.action.bound,setSelectedCryptoStatus:e.action.bound,setSelectedCryptoStatusDescription:e.action.bound,setIsCryptoTransactionsStatusModalVisible:e.action.bound,showCryptoTransactionsStatusModal:e.action.bound,hideCryptoTransactionsStatusModal:e.action.bound,setLoading:e.action.bound,setIsCryptoTransactionsVisible:e.action.bound}),this.root_store=o,this.WS=n}var n,o,i,s;return function(e,t,r){t&&Ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"onMount",value:(s=He(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.root_store.client,n=r.currency,o=r.switched,!n||!(0,t.isCryptocurrency)(n)||o){e.next=9;break}return this.setLoading(!0),e.next=6,this.unsubscribeCryptoTransactions();case 6:return e.next=8,this.getCryptoTransactions();case 8:this.setLoading(!1);case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"unsubscribeCryptoTransactions",value:(i=He(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.authorized.cashierPayments({provider:"crypto",transaction_type:"all"}).then((function(e){if(!e.error){var r=e.cashier_payments.crypto;t.setCryptoTransactionsHistory(r)}}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getCryptoTransactions",value:(o=He(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.subscribeCashierPayments((function(e){if(!e.error){var r=e.cashier_payments.crypto;t.updateCryptoTransactions(r)}}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setCryptoTransactionsHistory",value:function(e){this.crypto_transactions=e,this.sortCryptoTransactions()}},{key:"updateCryptoTransactions",value:function(e){var t=this;e.forEach((function(e){var r=t.crypto_transactions.findIndex((function(t){return t.id===e.id}));-1===r?t.crypto_transactions.push(e):Object.assign(t.crypto_transactions[r],e)})),this.sortCryptoTransactions()}},{key:"sortCryptoTransactions",value:function(){this.crypto_transactions.replace(this.crypto_transactions.slice().sort((function(e,t){return t.submit_date-e.submit_date})))}},{key:"cancelCryptoTransaction",value:(n=He(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.WS.cancelCryptoTransaction(t).then((function(e){return e.error?Promise.reject(e.error):(r.setSelectedCryptoTransactionId(""),r.setIsCryptoTransactionsCancelModalVisible(!1),Promise.resolve(e))}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setSelectedCryptoTransactionId",value:function(e){this.selected_crypto_transaction_id=e}},{key:"setIsCryptoTransactionsCancelModalVisible",value:function(e){this.is_crypto_transactions_cancel_modal_visible=e}},{key:"showCryptoTransactionsCancelModal",value:function(e){this.setSelectedCryptoTransactionId(e),this.setIsCryptoTransactionsCancelModalVisible(!0)}},{key:"hideCryptoTransactionsCancelModal",value:function(){this.setSelectedCryptoTransactionId(""),this.setIsCryptoTransactionsCancelModalVisible(!1)}},{key:"setSelectedCryptoStatus",value:function(e){this.selected_crypto_status=e}},{key:"setSelectedCryptoStatusDescription",value:function(e){this.selected_crypto_status_description=e}},{key:"setIsCryptoTransactionsStatusModalVisible",value:function(e){this.is_crypto_transactions_status_modal_visible=e}},{key:"showCryptoTransactionsStatusModal",value:function(e,t){this.setSelectedCryptoStatusDescription(e),this.setSelectedCryptoStatus(t),this.setIsCryptoTransactionsStatusModalVisible(!0)}},{key:"hideCryptoTransactionsStatusModal",value:function(){this.setIsCryptoTransactionsStatusModalVisible(!1)}},{key:"setLoading",value:function(e){this.is_loading=e}},{key:"setIsCryptoTransactionsVisible",value:function(e){this.is_crypto_transactions_visible=e}}]),r}();function ze(e,t,r,n,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function Ge(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){ze(i,n,o,s,a,"next",e)}function a(e){ze(i,n,o,s,a,"throw",e)}s(void 0)}))}}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ke=function(){function r(t){var n=t.WS,o=t.root_store;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.blockchain_address="",this.container=u.containers.withdraw,this.error=new p,this.is_10k_withdrawal_limit_reached=void 0,this.is_withdraw_confirmed=!1,this.verification=new Ie({root_store:this.root_store,WS:this.WS}),this.withdraw_amount="",this.max_withdraw_amount=0,this.crypto_config={},(0,e.makeObservable)(this,{blockchain_address:e.observable,container:e.observable,error:e.observable,is_10k_withdrawal_limit_reached:e.observable,is_withdraw_confirmed:e.observable,verification:e.observable,withdraw_amount:e.observable,max_withdraw_amount:e.observable,crypto_config:e.observable,setIsWithdrawConfirmed:e.action.bound,setWithdrawAmount:e.action.bound,requestWithdraw:e.action.bound,saveWithdraw:e.action.bound,resetWithrawForm:e.action.bound,setBlockchainAddress:e.action.bound,willMountWithdraw:e.action.bound,onMountWithdraw:e.action.bound,onMountCryptoWithdraw:e.action.bound,is_withdrawal_locked:e.computed,setMaxWithdrawAmount:e.action.bound,check10kLimit:e.action.bound,set10kLimitation:e.action.bound,setWithdrawPercentageSelectorResult:e.action.bound,validateWithdrawFromAmount:e.action.bound,validateWithdrawToAmount:e.action.bound,account_platform_icon:e.computed}),this.root_store=o,this.WS=n}var n,o,i,s,l;return function(e,t,r){t&&Xe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"setIsWithdrawConfirmed",value:function(e){var t=this.root_store.modules.cashier.crypto_fiat_converter.converter_from_amount;this.is_withdraw_confirmed=e,e&&this.setWithdrawAmount(t),!e&&this.verification&&this.verification.clearVerification()}},{key:"setWithdrawAmount",value:function(e){this.withdraw_amount=e}},{key:"requestWithdraw",value:(l=Ge(regeneratorRuntime.mark((function e(t){var r,n,o,i,s,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.root_store,n=r.client,o=r.modules,i=o.cashier,s=i.crypto_fiat_converter,a=i.error_dialog,n.is_logged_in){e.next=4;break}return e.abrupt("return");case 4:if(s.converter_from_amount){e.next=7;break}return s.setConverterFromError((0,c.localize)("This field is required.")),e.abrupt("return");case 7:return e.next=9,this.WS.cryptoWithdraw({address:this.blockchain_address,amount:+s.converter_from_amount,verification_code:t,dry_run:1}).then((function(e){e.error?a.setErrorMessage(e.error.message):u.saveWithdraw(t)}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"saveWithdraw",value:(s=Ge(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.root_store.modules.cashier.crypto_fiat_converter.converter_from_amount,this.error.setErrorMessage(""),e.next=4,this.WS.cryptoWithdraw({address:this.blockchain_address,amount:+r,verification_code:t}).then((function(e){e.error?(n.error.setErrorMessage(e.error),t&&n.verification.clearVerification(),n.resetWithrawForm()):n.setIsWithdrawConfirmed(!0)}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"resetWithrawForm",value:function(){var e=this.root_store.modules.cashier.crypto_fiat_converter,t=e.setConverterFromAmount,r=e.setConverterToAmount;this.setBlockchainAddress(""),t(""),r(""),this.verification.clearVerification()}},{key:"setBlockchainAddress",value:function(e){this.blockchain_address=e}},{key:"willMountWithdraw",value:function(e){e&&this.verification.clearVerification()}},{key:"onMountWithdraw",value:(i=Ge(regeneratorRuntime.mark((function e(t){var r,n,o,i,s,a,c,u,l,h,d,f,_,p,m,v,y,b,g,w,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.root_store,n=r.client,o=r.modules,i=o.cashier.general_store,s=i.active_container,a=i.is_crypto,c=i.onMountCommon,u=i.setLoading,l=i.setOnRemount,h=o.cashier.iframe,d=h.checkIframeLoaded,f=h.clearTimeoutCashierUrl,_=h.clearIframe,p=h.is_session_timeout,m=h.setContainerHeight,v=h.setIframeUrl,y=h.setSessionTimeout,b=h.setTimeoutCashierUrl,g=n.is_virtual,w=s,l(this.onMountWithdraw),e.next=8,c();case 8:if(this.error.setErrorMessage(""),m(0),_(),u(!0),p){e.next=15;break}return d(),e.abrupt("return");case 15:if(v(""),t&&!g){e.next=19;break}return u(!1),e.abrupt("return");case 19:return e.next=21,this.WS.authorized.cashier(s,{verification_code:t});case 21:if(k=e.sent,w===s){e.next=25;break}return u(!1),e.abrupt("return");case 25:if(!k.error){e.next=33;break}this.error.handleCashierError(k.error),u(!1),y(!0),f(),t&&this.verification.clearVerification(),e.next=43;break;case 33:if(!a){e.next=37;break}u(!1),e.next=43;break;case 37:return e.next=39,d();case 39:u(!1),v(k.cashier),y(!1),b();case 43:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onMountCryptoWithdraw",value:(o=Ge(regeneratorRuntime.mark((function e(t){var r,n,o,i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.root_store.modules.cashier,o=n.crypto_fiat_converter,i=n.general_store,s=n.iframe,i.setLoading(!0),!/^\w{8,128}$/.test(t)){e.next=9;break}return e.next=6,this.WS.cryptoWithdraw({address:this.blockchain_address,amount:+o.converter_from_amount,verification_code:t,dry_run:1});case 6:a=e.sent,e.next=10;break;case 9:a={error:{code:"InvalidToken",message:"Your token has expired or is invalid."}};case 10:if("InvalidToken"!==(null===(r=a.error)||void 0===r?void 0:r.code)){e.next=18;break}this.error.handleCashierError(a.error),i.setLoading(!1),s.setSessionTimeout(!0),s.clearTimeoutCashierUrl(),t&&this.verification.clearVerification(),e.next=31;break;case 18:return e.next=20,this.WS.cryptoConfig();case 20:if(e.t1=c=e.sent,e.t0=null===e.t1,e.t0){e.next=24;break}e.t0=void 0===c;case 24:if(!e.t0){e.next=28;break}e.t2=void 0,e.next=29;break;case 28:e.t2=c.crypto_config;case 29:this.crypto_config=e.t2,i.setLoading(!1);case 31:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"is_withdrawal_locked",get:function(){var e,t=this.root_store.client,r=t.account_status.authentication;if(null===(e=t.account_status)||void 0===e||!e.status)return!1;var n=r.needs_verification.includes("identity"),o=this.error.is_ask_authentication&&n;return t.is_withdrawal_lock||o||this.error.is_ask_financial_risk_approval}},{key:"setMaxWithdrawAmount",value:function(e){this.max_withdraw_amount=e}},{key:"check10kLimit",value:(n=Ge(regeneratorRuntime.mark((function e(){var r,n,o,i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.root_store.client,e.next=3,o.getLimits();case 3:if(e.t1=r=e.sent,e.t0=null===e.t1,e.t0){e.next=7;break}e.t0=void 0===r;case 7:if(!e.t0){e.next=11;break}e.t2=void 0,e.next=12;break;case 11:e.t2=null===(n=r.get_limits)||void 0===n?void 0:n.remainder;case 12:i=e.t2,this.setMaxWithdrawAmount(i),s=(0,t.getMinWithdrawal)(o.currency),a=!!(void 0!==i&&+i<s),this.set10kLimitation(a);case 17:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"set10kLimitation",value:function(e){this.is_10k_withdrawal_limit_reached=e}},{key:"setWithdrawPercentageSelectorResult",value:function(e){var t=this.root_store,r=t.client,n=t.modules.cashier,o=n.crypto_fiat_converter,i=n.general_store,s=r.currency,a=r.current_fiat_currency;e>0?(o.setConverterFromAmount(e),this.validateWithdrawFromAmount(),o.onChangeConverterFromAmount({target:{value:e}},s,a||"USD")):o.resetConverter(),o.setIsTimerVisible(!1),i.percentageSelectorSelectionStatus(!1)}},{key:"validateWithdrawFromAmount",value:function(){var e,r,n,o="",i=this.root_store,s=i.client,u=i.modules,l=s.balance,h=s.currency,d=u.cashier,f=d.crypto_fiat_converter,_=d.error_dialog,p=f.converter_from_amount,m=f.setConverterFromError,v=_.openReadMoreDialog,y=null===(e=this.crypto_config)||void 0===e||null===(r=e.currencies_config)||void 0===r||null===(n=r[h])||void 0===n?void 0:n.minimum_withdrawal,b=+this.max_withdraw_amount>+l?+l:+this.max_withdraw_amount,g=(0,t.formatMoney)(h,l,!0),w=(0,t.formatMoney)(h,y,!0),k=(0,t.formatMoney)(h,b,!0);if(p){var C=(0,t.validNumber)(p,{type:"float",decimals:(0,t.getDecimalPlaces)(h)}),S=C.is_ok,T=C.message;if(S?+l<+p?o=(0,c.localize)("Insufficient funds"):+l<+y?o=(0,c.localize)("Your balance ({{format_balance}} {{currency}}) is less than the current minimum withdrawal allowed ({{format_min_withdraw_amount}} {{currency}}). Please top up your account to continue with your withdrawal.",{format_balance:g,currency:h,format_min_withdraw_amount:w}):(+p<+y||+p>+b)&&(o=(0,c.localize)("The current allowed withdraw amount is {{format_min_withdraw_amount}} to {{format_max_withdraw_amount}} {{currency}}",{format_min_withdraw_amount:w,format_max_withdraw_amount:k,currency:h})):o=T,(0,t.isMobile)()&&o.length>35){var A=o;o=a().createElement(F.ReadMore,{expand_text:(0,c.localize)("more"),text:A,collapse_length:28,openDialog:function(){return v(A,(0,c.localize)("OK"))},show_dialog:!0})}}m(o)}},{key:"validateWithdrawToAmount",value:function(){var e="",r=this.root_store,n=r.client,o=r.modules,i=n.current_fiat_currency,s=o.cashier.crypto_fiat_converter,a=s.converter_to_amount,c=s.setConverterToError;if(a){var u=(0,t.validNumber)(a,{type:"float",decimals:(0,t.getDecimalPlaces)(i)}),l=u.is_ok,h=u.message;l||(e=h)}c(e)}},{key:"account_platform_icon",get:function(){var e=this.root_store.client,t=e.account_list,r=e.loginid;return t.find((function(e){return r===e.loginid})).icon}}]),r}();function Je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ye=function(e,t,r){return t&&Je(e.prototype,t),r&&Je(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){var r=t.root_store,n=t.WS;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.account_prompt_dialog=new i(r),this.account_transfer=new A({root_store:r,WS:n}),this.crypto_fiat_converter=new O({root_store:r,WS:n}),this.deposit=new D({root_store:r,WS:n}),this.error_dialog=new L,this.error=new p,this.general_store=new he({root_store:r,WS:n}),this.iframe=new _e({root_store:r,WS:n}),this.onramp=new Ae({root_store:r,WS:n}),this.payment_agent=new We({root_store:r,WS:n}),this.payment_agent_transfer=new Be({root_store:r,WS:n}),this.transaction_history=new qe({root_store:r,WS:n}),this.verification=new Ie({root_store:r,WS:n}),this.withdraw=new Ke({root_store:r,WS:n})}))})(),d.default})()}));